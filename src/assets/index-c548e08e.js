import{cQ as Ae,cR as $e,r as h,a as me,J as a,G as he,bp as ye,a_ as _e,I as $,n as se,q as u,b1 as be,bv as Ie,D as ue,E as q,X as Fe,ct as Xe,b as s,F as De,a1 as Ke,U as We,cS as Ye,H as ne,bh as re,ba as Le,a7 as Ze,cT as He,K as Se,P as Be,bk as qe,bC as Je,by as Qe,aX as er,z as Oe,bA as Me,cp as rr,cN as nr}from"./index-08ed677d.js";import{a as ar,g as Re}from"./css-aae66f86.js";import{R as tr,a as ir,Z as or,b as lr}from"./ZoomOutOutlined-0d16791b.js";var ur="[object Number]";function sr(o){return typeof o=="number"||Ae(o)&&$e(o)==ur}function vr(o){var e=h(null),l=me(a({},o)),r=h([]),i=function(w){e.value===null&&(r.value=[],e.value=ye(function(){var d;r.value.forEach(function(N){d=a(a({},d),N)}),_e(l,d),e.value=null})),r.value.push(w)};return he(function(){e.value&&ye.cancel(e.value)}),[l,i]}function ke(o,e,l,r){var i=e+l,n=(l-r)/2;if(l>r){if(e>0)return $({},o,n);if(e<0&&i<r)return $({},o,-n)}else if(e<0||i>r)return $({},o,e<0?n:-n);return{}}function cr(o,e,l,r){var i=ar(),n=i.width,w=i.height,d=null;return o<=n&&e<=w?d={x:0,y:0}:(o>n||e>w)&&(d=a(a({},ke("x",l,o,n)),ke("y",r,e,w))),d}var Ne=Symbol("previewGroupContext"),xe={provide:function(e){Ke(Ne,e)},inject:function(){return We(Ne,{isPreviewGroup:h(!1),previewUrls:u(function(){return new Map}),setPreviewUrls:function(){},current:h(null),setCurrent:function(){},setShowPreview:function(){},setMousePosition:function(){},registerImage:null,rootClassName:""})}},fr=se({compatConfig:{MODE:3},name:"PreviewGroup",inheritAttrs:!1,props:{previewPrefixCls:String,preview:{type:[Boolean,Object],default:!0},icons:{type:Object,default:function(){return{}}}},setup:function(e,l){var r=l.slots,i=u(function(){var m={visible:void 0,onVisibleChange:function(){},getContainer:void 0,current:0};return be(e.preview)==="object"?Ue(e.preview,m):m}),n=me(new Map),w=h(),d=u(function(){return i.value.visible}),N=u(function(){return i.value.getContainer}),T=function(v,k){var P,O;(P=(O=i.value).onVisibleChange)===null||P===void 0||P.call(O,v,k)},b=Ie(!!d.value,{value:d,onChange:T}),C=ue(b,2),A=C[0],g=C[1],y=h(null),J=u(function(){return d.value!==void 0}),X=u(function(){return Array.from(n.keys())}),x=u(function(){return X.value[i.value.current]}),D=u(function(){return new Map(Array.from(n).filter(function(m){var v=ue(m,2),k=v[1].canPreview;return!!k}).map(function(m){var v=ue(m,2),k=v[0],P=v[1].url;return[k,P]}))}),G=function(v,k){var P=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;n.set(v,{url:k,canPreview:P})},L=function(v){w.value=v},S=function(v){y.value=v},M=function(v,k){var P=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,O=function(){n.delete(v)};return n.set(v,{url:k,canPreview:P}),O},j=function(v){v==null||v.stopPropagation(),g(!1),S(null)};return q(x,function(m){L(m)},{immediate:!0,flush:"post"}),Fe(function(){A.value&&J.value&&L(x.value)},{flush:"post"}),xe.provide({isPreviewGroup:h(!0),previewUrls:D,setPreviewUrls:G,current:w,setCurrent:L,setShowPreview:g,setMousePosition:S,registerImage:M}),function(){var m=_e({},(Xe(i.value),i.value));return s(De,null,[r.default&&r.default(),s(je,a(a({},m),{},{"ria-hidden":!A.value,visible:A.value,prefixCls:e.previewPrefixCls,onClose:j,mousePosition:y.value,src:D.value.get(w.value),icons:e.icons,getContainer:N.value}),null)])}}});const Ge=fr;var H={x:0,y:0},mr=a(a({},Ye()),{},{src:String,alt:String,rootClassName:String,icons:{type:Object,default:function(){return{}}}}),dr=se({compatConfig:{MODE:3},name:"Preview",inheritAttrs:!1,props:mr,emits:["close","afterClose"],setup:function(e,l){var r=l.emit,i=l.attrs,n=me(e.icons),w=n.rotateLeft,d=n.rotateRight,N=n.zoomIn,T=n.zoomOut,b=n.close,C=n.left,A=n.right,g=h(1),y=h(0),J=vr(H),X=ue(J,2),x=X[0],D=X[1],G=function(){return r("close")},L=h(),S=me({originX:0,originY:0,deltaX:0,deltaY:0}),M=h(!1),j=xe.inject(),m=j.previewUrls,v=j.current,k=j.isPreviewGroup,P=j.setCurrent,O=u(function(){return m.value.size}),_=u(function(){return Array.from(m.value.keys())}),I=u(function(){return _.value.indexOf(v.value)}),de=u(function(){return k.value?m.value.get(v.value):e.src}),ae=u(function(){return k.value&&O.value>1}),te=h({wheelDirection:0}),K=function(){g.value=1,y.value=0,D(H),r("afterClose")},W=function(){g.value++,D(H)},ie=function(){g.value>1&&g.value--,D(H)},f=function(){y.value+=90},p=function(){y.value-=90},z=function(t){t.preventDefault(),t.stopPropagation(),I.value>0&&P(_.value[I.value-1])},U=function(t){t.preventDefault(),t.stopPropagation(),I.value<O.value-1&&P(_.value[I.value+1])},V=ne($({},"".concat(e.prefixCls,"-moving"),M.value)),ge="".concat(e.prefixCls,"-operations-operation"),ve="".concat(e.prefixCls,"-operations-icon"),we=[{icon:b,onClick:G,type:"close"},{icon:N,onClick:W,type:"zoomIn"},{icon:T,onClick:ie,type:"zoomOut",disabled:u(function(){return g.value===1})},{icon:d,onClick:f,type:"rotateRight"},{icon:w,onClick:p,type:"rotateLeft"}],oe=function(){if(e.visible&&M.value){var t=L.value.offsetWidth*g.value,R=L.value.offsetHeight*g.value,Y=Re(L.value),E=Y.left,Z=Y.top,F=y.value%180!==0;M.value=!1;var Q=cr(F?R:t,F?t:R,E,Z);Q&&D(a({},Q))}},pe=function(t){t.button===0&&(t.preventDefault(),t.stopPropagation(),S.deltaX=t.pageX-x.x,S.deltaY=t.pageY-x.y,S.originX=x.x,S.originY=x.y,M.value=!0)},ce=function(t){e.visible&&M.value&&D({x:t.pageX-S.deltaX,y:t.pageY-S.deltaY})},fe=function(t){if(e.visible){t.preventDefault();var R=t.deltaY;te.value={wheelDirection:R}}},Ce=function(t){!e.visible||!ae.value||(t.preventDefault(),t.keyCode===Se.LEFT?I.value>0&&P(_.value[I.value-1]):t.keyCode===Se.RIGHT&&I.value<O.value-1&&P(_.value[I.value+1]))},Pe=function(){e.visible&&(g.value!==1&&(g.value=1),(x.x!==H.x||x.y!==H.y)&&D(H))},le=function(){};return he(function(){q([function(){return e.visible},M],function(){le();var c,t,R=re(window,"mouseup",oe,!1),Y=re(window,"mousemove",ce,!1),E=re(window,"wheel",fe,{passive:!1}),Z=re(window,"keydown",Ce,!1);try{window.top!==window.self&&(c=re(window.top,"mouseup",oe,!1),t=re(window.top,"mousemove",ce,!1))}catch(F){}le=function(){R.remove(),Y.remove(),E.remove(),Z.remove(),c&&c.remove(),t&&t.remove()}},{flush:"post",immediate:!0}),q([te],function(){var c=te.value.wheelDirection;c>0?ie():c<0&&W()})}),Le(function(){le()}),function(){var c=e.visible,t=e.prefixCls,R=e.rootClassName;return s(He,a(a({},i),{},{transitionName:"zoom",maskTransitionName:"fade",closable:!1,keyboard:!0,prefixCls:t,onClose:G,afterClose:K,visible:c,wrapClassName:V,rootClassName:R,getContainer:e.getContainer}),{default:function(){return[s("ul",{class:"".concat(e.prefixCls,"-operations")},[we.map(function(E){var Z=E.icon,F=E.onClick,Q=E.type,ee=E.disabled;return s("li",{class:ne(ge,$({},"".concat(e.prefixCls,"-operations-operation-disabled"),ee&&(ee==null?void 0:ee.value))),onClick:F,key:Q},[Ze(Z,{class:ve})])})]),s("div",{class:"".concat(e.prefixCls,"-img-wrapper"),style:{transform:"translate3d(".concat(x.x,"px, ").concat(x.y,"px, 0)")}},[s("img",{onMousedown:pe,onDblclick:Pe,ref:L,class:"".concat(e.prefixCls,"-img"),src:de.value,alt:e.alt,style:{transform:"scale3d(".concat(g.value,", ").concat(g.value,", 1) rotate(").concat(y.value,"deg)")}},null)]),ae.value&&s("div",{class:ne("".concat(e.prefixCls,"-switch-left"),$({},"".concat(e.prefixCls,"-switch-left-disabled"),I.value<=0)),onClick:z},[C]),ae.value&&s("div",{class:ne("".concat(e.prefixCls,"-switch-right"),$({},"".concat(e.prefixCls,"-switch-right-disabled"),I.value>=O.value-1)),onClick:U},[A])]}})}}});const je=dr;var gr=["icons","maskClassName"],ze=function(){return{src:String,wrapperClassName:String,wrapperStyle:{type:Object,default:void 0},rootClassName:String,prefixCls:String,previewPrefixCls:String,previewMask:{type:[Boolean,Function],default:void 0},placeholder:Be.any,fallback:String,preview:{type:[Boolean,Object],default:!0},onClick:{type:Function},onError:{type:Function}}},Ue=function(e,l){var r=a({},e);return Object.keys(l).forEach(function(i){e[i]===void 0&&(r[i]=l[i])}),r},wr=0,Ve=se({compatConfig:{MODE:3},name:"Image",inheritAttrs:!1,props:ze(),emits:["click","error"],setup:function(e,l){var r=l.attrs,i=l.slots,n=l.emit,w=u(function(){return e.prefixCls}),d=u(function(){return"".concat(w.value,"-preview")}),N=u(function(){var f={visible:void 0,onVisibleChange:function(){},getContainer:void 0};return be(e.preview)==="object"?Ue(e.preview,f):f}),T=u(function(){var f;return(f=N.value.src)!==null&&f!==void 0?f:e.src}),b=u(function(){return e.placeholder&&e.placeholder!==!0||i.placeholder}),C=u(function(){return N.value.visible}),A=u(function(){return N.value.getContainer}),g=u(function(){return C.value!==void 0}),y=function(p,z){var U,V;(U=(V=N.value).onVisibleChange)===null||U===void 0||U.call(V,p,z)},J=Ie(!!C.value,{value:C,onChange:y}),X=ue(J,2),x=X[0],D=X[1];q(x,function(f,p){y(f,p)});var G=h(b.value?"loading":"normal");q(function(){return e.src},function(){G.value=b.value?"loading":"normal"});var L=h(null),S=u(function(){return G.value==="error"}),M=xe.inject(),j=M.isPreviewGroup,m=M.setCurrent,v=M.setShowPreview,k=M.setMousePosition,P=M.registerImage,O=h(wr++),_=u(function(){return e.preview&&!S.value}),I=function(){G.value="normal"},de=function(p){G.value="error",n("error",p)},ae=function(p){if(!g.value){var z=Re(p.target),U=z.left,V=z.top;j.value?(m(O.value),k({x:U,y:V})):L.value={x:U,y:V}}j.value?v(!0):D(!0),n("click",p)},te=function(){D(!1),g.value||(L.value=null)},K=h(null);q(function(){return K},function(){G.value==="loading"&&K.value.complete&&(K.value.naturalWidth||K.value.naturalHeight)&&I()});var W=function(){};he(function(){q([T,_],function(){if(W(),!j.value)return function(){};W=P(O.value,T.value,_.value),_.value||W()},{flush:"post",immediate:!0})}),Le(function(){W()});var ie=function(p){return sr(p)?p+"px":p};return function(){var f=e.prefixCls,p=e.wrapperClassName,z=e.fallback,U=e.src,V=e.placeholder,ge=e.wrapperStyle,ve=e.rootClassName,we=r.width,oe=r.height,pe=r.crossorigin,ce=r.decoding,fe=r.alt,Ce=r.sizes,Pe=r.srcset,le=r.usemap,c=r.class,t=r.style,R=N.value,Y=R.icons,E=R.maskClassName,Z=qe(R,gr),F=ne(f,p,ve,$({},"".concat(f,"-error"),S.value)),Q=S.value&&z?z:T.value,ee={crossorigin:pe,decoding:ce,alt:fe,sizes:Ce,srcset:Pe,usemap:le,class:ne("".concat(f,"-img"),$({},"".concat(f,"-img-placeholder"),V===!0),c),style:a({height:oe},t)};return s(De,null,[s("div",{class:F,onClick:_.value?ae:function(Te){n("click",Te)},style:a({width:ie(we),height:ie(oe)},ge)},[s("img",a(a(a({},ee),S.value&&z?{src:z}:{onLoad:I,onError:de,src:U}),{},{ref:K}),null),G.value==="loading"&&s("div",{"aria-hidden":"true",class:"".concat(f,"-placeholder")},[V||i.placeholder&&i.placeholder()]),i.previewMask&&_.value&&s("div",{class:["".concat(f,"-mask"),E]},[i.previewMask()])]),!j.value&&_.value&&s(je,a(a({},Z),{},{"aria-hidden":!x.value,visible:x.value,prefixCls:d.value,onClose:te,mousePosition:L.value,src:Q,alt:fe,getContainer:A.value,icons:Y,rootClassName:ve}),null)])}}});Ve.PreviewGroup=Ge;const pr=Ve;var Ee={rotateLeft:s(tr,null,null),rotateRight:s(ir,null,null),zoomIn:s(or,null,null),zoomOut:s(lr,null,null),close:s(Je,null,null),left:s(Qe,null,null),right:s(er,null,null)},Cr=se({compatConfig:{MODE:3},name:"AImagePreviewGroup",inheritAttrs:!1,props:{previewPrefixCls:String},setup:function(e,l){var r=l.attrs,i=l.slots,n=Oe("image",e),w=n.getPrefixCls,d=u(function(){return w("image-preview",e.previewPrefixCls)});return function(){return s(Ge,a(a({},a(a({},r),e)),{},{icons:Ee,previewPrefixCls:d.value}),i)}}});const Pr=Cr;var B=se({name:"AImage",inheritAttrs:!1,props:ze(),setup:function(e,l){var r=l.slots,i=l.attrs,n=Oe("image",e),w=n.prefixCls,d=n.rootPrefixCls,N=n.configProvider,T=u(function(){var b=e.preview;if(b===!1)return b;var C=be(b)==="object"?b:{};return a(a({icons:Ee},C),{},{transitionName:Me(d.value,"zoom",C.transitionName),maskTransitionName:Me(d.value,"fade",C.maskTransitionName)})});return function(){var b,C=((b=N.locale)===null||b===void 0?void 0:b.Image)||rr.Image,A=function(){return s("div",{class:"".concat(w.value,"-mask-info")},[s(nr,null,null),C==null?void 0:C.preview])},g=e.previewMask,y=g===void 0?r.previewMask||A:g;return s(pr,a(a({},a(a(a({},i),e),{},{prefixCls:w.value})),{},{preview:T.value}),a(a({},r),{},{previewMask:typeof y=="function"?y:null}))}}});B.PreviewGroup=Pr;B.install=function(o){return o.component(B.name,B),o.component(B.PreviewGroup.name,B.PreviewGroup),o};const yr=B;export{yr as _,Pr as a};
