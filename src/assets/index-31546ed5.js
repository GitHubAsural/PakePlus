import{aG as D,o as I,c as U,w as o,b as a,u as p,e as $,ax as K,aw as M,ar as V,g as F,az as E,r as _,a as P,E as j,m as x,aH as Z,aq as q,d as w,ah as z,an as A,dr as G,ds as H,Z as J,cx as T,aZ as Q,N as W,j as X,b5 as Y,aU as B,aM as ee,aV as te,h as ae}from"./index-08ed677d.js";import{_ as oe,a as le,C as ne}from"./index-7b650976.js";/* empty css              *//* empty css              *//* empty css              *//* empty css              */import"./index-5362a68f.js";import{i as se}from"./index-c83262a0.js";import{_ as re}from"./index-47899940.js";import{u as ie,a as ue,b as ce,c as de,p as me,r as pe,d as _e}from"./index-91c24823.js";import{c as ve}from"./index-ffe2e608.js";import{D as fe}from"./DeleteOutlined-a1ce9a16.js";import"./vuedraggable.umd-a1c90dfc.js";import"./index-9d5a19c2.js";import"./Group-db28a0f9.js";import"./createForOfIteratorHelper-a50550d1.js";import"./css-aae66f86.js";import"./useMaxLevel-5fff0ff6.js";import"./index-5353e7c4.js";import"./RadioButton-b1164875.js";import"./CaretDownOutlined-5ddc51ec.js";import"./CaretUpOutlined-d8859d1d.js";import"./iconUtil-c5959902.js";const ge={__name:"role-search",emits:["search"],setup(k,{emit:f}){const{form:r,resetFields:i}=D({roleName:"",roleCode:"",comments:""}),c=()=>{f("search",r)},m=()=>{i(),c()};return(u,d)=>{const g=K,h=M,b=oe,s=V,n=F,e=le,t=E;return I(),U(t,{"label-col":{xl:7,lg:5,md:7,sm:4},"wrapper-col":{xl:17,lg:19,md:17,sm:20}},{default:o(()=>[a(e,{gutter:8},{default:o(()=>[a(b,{xl:6,lg:12,md:12,sm:24,xs:24},{default:o(()=>[a(h,{label:"角色名称"},{default:o(()=>[a(g,{value:p(r).roleName,"onUpdate:value":d[0]||(d[0]=l=>p(r).roleName=l),valueModifiers:{trim:!0},placeholder:"请输入","allow-clear":""},null,8,["value"])]),_:1})]),_:1}),a(b,{xl:6,lg:12,md:12,sm:24,xs:24},{default:o(()=>[a(h,{label:"角色标识"},{default:o(()=>[a(g,{value:p(r).roleCode,"onUpdate:value":d[1]||(d[1]=l=>p(r).roleCode=l),valueModifiers:{trim:!0},placeholder:"请输入","allow-clear":""},null,8,["value"])]),_:1})]),_:1}),a(b,{xl:6,lg:12,md:12,sm:24,xs:24},{default:o(()=>[a(h,{label:"备注"},{default:o(()=>[a(g,{value:p(r).comments,"onUpdate:value":d[2]||(d[2]=l=>p(r).comments=l),valueModifiers:{trim:!0},placeholder:"请输入","allow-clear":""},null,8,["value"])]),_:1})]),_:1}),a(b,{xl:6,lg:12,md:12,sm:24,xs:24},{default:o(()=>[a(h,{class:"ele-text-right","wrapper-col":{span:24}},{default:o(()=>[a(n,null,{default:o(()=>[a(s,{type:"primary",onClick:c},{default:o(()=>[$("查询")]),_:1}),a(s,{onClick:m},{default:o(()=>[$("重置")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})}}},he={__name:"role-edit",props:{visible:Boolean,data:Object},emits:["done","update:visible"],setup(k,{emit:f}){const r=k,i=_(null),c=_(!1),m=_(!1),{form:u,resetFields:d,assignFields:g}=D({roleId:void 0,roleName:"",roleCode:"",comments:""}),h=P({roleName:[{required:!0,message:"请输入角色名称",type:"string",trigger:"blur"}],roleCode:[{required:!0,message:"请输入角色标识",type:"string",trigger:"blur"}]}),b=()=>{i.value&&i.value.validate().then(()=>{m.value=!0,(c.value?ie:ue)(u).then(e=>{m.value=!1,x.success(e),s(!1),f("done")}).catch(e=>{m.value=!1,x.error(e.message)})}).catch(()=>{})},s=n=>{f("update:visible",n)};return j(()=>r.visible,n=>{var e;n?r.data?(g(r.data),c.value=!0):c.value=!1:(d(),(e=i.value)==null||e.clearValidate())}),(n,e)=>{const t=K,l=M,v=Z,N=E,R=q;return I(),U(R,{width:460,visible:k.visible,"confirm-loading":m.value,title:c.value?"修改角色":"添加角色","body-style":{paddingBottom:"8px"},"onUpdate:visible":s,onOk:b},{default:o(()=>[a(N,{ref_key:"formRef",ref:i,model:p(u),rules:h,"label-col":{md:5,sm:5,xs:24},"wrapper-col":{md:19,sm:19,xs:24}},{default:o(()=>[a(l,{label:"角色名称",name:"roleName"},{default:o(()=>[a(t,{"allow-clear":"",maxlength:20,placeholder:"请输入角色名称",value:p(u).roleName,"onUpdate:value":e[0]||(e[0]=C=>p(u).roleName=C)},null,8,["value"])]),_:1}),a(l,{label:"角色标识",name:"roleCode"},{default:o(()=>[a(t,{"allow-clear":"",maxlength:20,placeholder:"请输入角色标识",value:p(u).roleCode,"onUpdate:value":e[1]||(e[1]=C=>p(u).roleCode=C)},null,8,["value"])]),_:1}),a(l,{label:"备注"},{default:o(()=>[a(v,{rows:4,maxlength:200,placeholder:"请输入备注",value:p(u).comments,"onUpdate:value":e[2]||(e[2]=C=>p(u).comments=C)},null,8,["value"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["visible","confirm-loading","title"])}}},be={style:{height:"60vh"},class:"ele-scrollbar-hover"},xe={components:G},ye=Object.assign(xe,{__name:"role-auth",props:{visible:Boolean,data:Object},emits:["update:visible"],setup(k,{emit:f}){const r=k,i=_([]),c=_(!1),m=_(!1),u=_([]),d=_([]),g=()=>{i.value=[],u.value=[],d.value=[],r.data&&(c.value=!0,ce(r.data.roleId).then(s=>{c.value=!1,i.value=H({data:s==null?void 0:s.map(n=>({...n,key:n.menuId,icon:void 0,menuIcon:n.icon})),idField:"menuId",parentIdField:"parentId",addParentIds:!0,parentIds:[]}),J(()=>{const n=[],e=[];T(i.value,t=>{var l;t.key&&((l=t.children)!=null&&l.length?n.push(t.key):t.checked&&e.push(t.key))}),u.value=n,d.value=e})}).catch(s=>{c.value=!1,x.error(s.message)}))},h=()=>{var n;m.value=!0;const s=new Set;T(i.value,e=>{e.key&&d.value.some(t=>t===e.key)&&(s.add(e.key),e.parentIds&&e.parentIds.forEach(t=>{s.add(t)}))}),de((n=r.data)==null?void 0:n.roleId,Array.from(s)).then(e=>{m.value=!1,x.success(e),b(!1)}).catch(e=>{m.value=!1,x.error(e.message)})},b=s=>{f("update:visible",s)};return j(()=>r.visible,s=>{s&&g()}),(s,n)=>{const e=ve,t=Q,l=q;return I(),U(l,{width:460,title:"分配权限",visible:k.visible,"confirm-loading":m.value,"onUpdate:visible":b,onOk:h},{default:o(()=>[a(t,{spinning:c.value},{default:o(()=>[w("div",be,[a(e,{checkable:!0,"show-icon":!0,"tree-data":i.value,expandedKeys:u.value,"onUpdate:expandedKeys":n[0]||(n[0]=v=>u.value=v),checkedKeys:d.value,"onUpdate:checkedKeys":n[1]||(n[1]=v=>d.value=v)},{icon:o(({menuIcon:v})=>[v?(I(),U(z(v),{key:0})):A("",!0)]),_:1},8,["tree-data","expandedKeys","checkedKeys"])])]),_:1},8,["spinning"])]),_:1},8,["visible","confirm-loading"])}}}),ke={class:"ele-body"},Ce=w("span",null,"新建",-1),Ie=w("span",null,"删除",-1),we=["onClick"],Ue=["onClick"],Ne=w("a",{class:"ele-text-danger"},"删除",-1),Re={name:"SystemRole"},Xe=Object.assign(Re,{setup(k){const f=_(null),r=_([{key:"index",width:48,align:"center",fixed:"left",hideInSetting:!0,customRender:({index:e})=>{var t,l;return e+((l=(t=f.value)==null?void 0:t.tableIndex)!=null?l:0)}},{title:"角色名称",dataIndex:"roleName",sorter:!0,showSorterTooltip:!1},{title:"角色标识",dataIndex:"roleCode",sorter:!0,showSorterTooltip:!1},{title:"备注",dataIndex:"comments",sorter:!0,showSorterTooltip:!1},{title:"创建时间",dataIndex:"createTime",sorter:!0,showSorterTooltip:!1,ellipsis:!0,customRender:({text:e})=>W(e)},{title:"操作",key:"action",width:200,align:"center"}]),i=_([]),c=_(null),m=_(!1),u=_(!1),d=({page:e,limit:t,where:l,orders:v})=>me({...l,...v,page:e,limit:t}),g=e=>{var t;i.value=[],(t=f==null?void 0:f.value)==null||t.reload({page:1,where:e})},h=e=>{c.value=e!=null?e:null,m.value=!0},b=e=>{c.value=e!=null?e:null,u.value=!0},s=e=>{const t=B("请求中..",0);pe(e.roleId).then(l=>{t(),x.success(l),g()}).catch(l=>{t(),x.error(l.message)})},n=()=>{if(!i.value.length){x.error("请至少选择一条数据");return}ee.confirm({title:"提示",content:"确定要删除选中的角色吗?",icon:a(te),maskClosable:!0,onOk:()=>{const e=B("请求中..",0);_e(i.value.map(t=>t.roleId)).then(t=>{e(),x.success(t),g()}).catch(t=>{e(),x.error(t.message)})}})};return(e,t)=>{const l=V,v=F,N=ae,R=re,C=se,L=ne;return I(),X("div",ke,[a(L,{bordered:!1},{default:o(()=>[a(ge,{onSearch:g}),a(C,{ref_key:"tableRef",ref:f,"row-key":"roleId",columns:r.value,datasource:d,selection:i.value,"onUpdate:selection":t[1]||(t[1]=y=>i.value=y),scroll:{x:800},"cache-key":"proSystemRoleTable"},{toolbar:o(()=>[a(v,null,{default:o(()=>[a(l,{type:"primary",class:"ele-btn-icon",onClick:t[0]||(t[0]=y=>h())},{icon:o(()=>[a(p(Y))]),default:o(()=>[Ce]),_:1}),a(l,{danger:"",type:"primary",class:"ele-btn-icon",onClick:n},{icon:o(()=>[a(p(fe))]),default:o(()=>[Ie]),_:1})]),_:1})]),bodyCell:o(({column:y,record:O})=>[y.key==="action"?(I(),U(v,{key:0},{default:o(()=>[w("a",{onClick:S=>h(O)},"修改",8,we),a(N,{type:"vertical"}),w("a",{onClick:S=>b(O)},"分配权限",8,Ue),a(N,{type:"vertical"}),a(R,{placement:"topRight",title:"确定要删除此角色吗？",onConfirm:S=>s(O)},{default:o(()=>[Ne]),_:2},1032,["onConfirm"])]),_:2},1024)):A("",!0)]),_:1},8,["columns","selection"])]),_:1}),a(he,{visible:m.value,"onUpdate:visible":t[2]||(t[2]=y=>m.value=y),data:c.value,onDone:g},null,8,["visible","data"]),a(ye,{visible:u.value,"onUpdate:visible":t[3]||(t[3]=y=>u.value=y),data:c.value},null,8,["visible","data"])])}}});export{Xe as default};
