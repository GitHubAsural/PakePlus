import{n as L,aD as X,r as H,q as Y,G as U,E as V,o as B,j as O,aE as q,d as z,ai as J,_ as Q,b as _,w as y}from"./index-08ed677d.js";import{C as Z}from"./index-7b650976.js";function W(t){return Object.assign({color:"rgba(68, 68, 68, .25)",fontSize:16,fontWeight:"normal",fontFamily:"sans-serif",fontStyle:"normal"},t)}function K(t){const[r,a]=t!=null?t:[];return[r!=null?r:100,a!=null?a:100]}function M(){return window.devicePixelRatio||1}function I(t,r,a,c){t.translate(r,a),t.rotate(Math.PI/180*Number(c)),t.translate(-r,-a)}const tt={width:Number,height:Number,rotate:Number,zIndex:Number,image:String,content:[String,Array],font:Object,gap:Array,offset:Array},k=2,j=3,et=L({name:"EleWatermark",props:tt,setup(t){const{authenticated:r}=X(),a=H(null),c=H(null),A=Y(()=>{var e;const n={};return!r||!a.value?n.display="none":(n.backgroundImage=`url('${a.value}')`,c.value&&(n.backgroundSize=c.value),n.zIndex=(e=t.zIndex)!=null?e:9),n}),p=n=>{if(t.image||!n.measureText)return 120;const e=t.content,i=(Array.isArray(e)?e:[e]).map(g=>n.measureText(g).width);return Math.ceil(Math.max(...i))},$=n=>{if(t.image||!n.measureText)return 64;const e=t.content,o=Array.isArray(e)?e:[e],{fontSize:i}=W(t.font);return i*o.length+(o.length-1)*j},x=n=>{const e=t.width,o=t.height;return[e!=null?e:p(n),o!=null?o:$(n)]},D=(n,e,o,i,g)=>{const s=M(),{color:u,fontSize:w,fontStyle:v,fontWeight:b,fontFamily:f}=W(t.font),l=w*s;n.font=`${v} normal ${b} ${l}px/${g}px ${f}`,n.fillStyle=u,n.textAlign="center",n.textBaseline="top",n.translate(i/2,0);const h=t.content;(Array.isArray(h)?h:[h]).forEach((m,S)=>{n.fillText(m!=null?m:"",e,o+S*(l+j*s))})},P=()=>{var F;const n=document.createElement("canvas"),e=n.getContext("2d");if(!e)return;const o=(F=t.rotate)!=null?F:-22;if(!t.image&&e.measureText!=null){const{fontSize:d,fontFamily:G}=W(t.font);e.font=`${d}px ${G}`}const[i,g]=x(e),s=M(),[u,w]=K(t.gap),v=(u+i)*s,b=(w+g)*s;n.setAttribute("width",`${v*k}px`),n.setAttribute("height",`${b*k}px`);const f=i*s,l=g*s,h=(f+u*s)/2,E=(l+w*s)/2;e.save(),I(e,h,E,o);const m=u*s/2,S=w*s/2,N=m+v,R=S+b,T=h+v,C=E+b;if(t.image){const d=new Image;d.onload=()=>{e.drawImage(d,m,S,f,l),e.restore(),I(e,T,C,o),e.drawImage(d,N,R,f,l),a.value=n.toDataURL(),c.value=`${(u+i)*k}px`},d.crossOrigin="anonymous",d.referrerPolicy="no-referrer",d.src=t.image}else D(e,m,S,f,l),e.restore(),I(e,T,C,o),D(e,N,R,f,l),a.value=n.toDataURL(),c.value=`${(u+i)*k}px`};return U(()=>{P()}),V(()=>t,()=>{P()},{deep:!0}),{imgStyle:A}}}),nt=(t,r)=>{const a=t.__vccOpts||t;for(const[c,A]of r)a[c]=A;return a},at={class:"ele-watermark"};function ot(t,r,a,c,A,p){return B(),O("div",at,[q(t.$slots,"default"),z("div",{class:"ele-watermark-img",style:J(t.imgStyle)},null,4)])}const rt=nt(et,[["render",ot]]);const st={name:"ExtensionWatermark"},ct={class:"ele-body ele-body-card"},it=z("div",{style:{height:"200px"}},null,-1),lt=z("div",{style:{height:"200px"}},null,-1),dt=z("div",{style:{height:"200px"}},null,-1);function ut(t,r,a,c,A,p){const $=rt,x=Z;return B(),O("div",ct,[_(x,{title:"基本用法",bordered:!1},{default:y(()=>[_($,{content:"Ele Admin Pro",gap:[60,40]},{default:y(()=>[it]),_:1})]),_:1}),_(x,{title:"多行水印",bordered:!1},{default:y(()=>[_($,{content:["Ele Admin Pro","Happy Working"],gap:[60,40]},{default:y(()=>[lt]),_:1})]),_:1}),_(x,{title:"图片水印",bordered:!1},{default:y(()=>[_($,{height:30,width:130,image:"https://mdn.alipayobjects.com/huamei_7uahnr/afts/img/A*lkAoRbywo0oAAAAAAAAAAAAADrJ8AQ/original",gap:[60,40]},{default:y(()=>[dt]),_:1})]),_:1})])}const gt=Q(st,[["render",ut]]);export{gt as default};
