import{b,A as J,n as G,f as Oe,r as A,E as P,ag as O,o as T,j as H,w as k,aE as pe,cx as Z,bD as We,cy as Ye,q as I,c as V,d as E,e as D,t as B,an as N,aF as me,am as Xe,g as et,al as tt,ak as nt,bJ as lt,cz as at,cA as ot,aP as it,u as he,F as ge,k as ut,ai as rt,aD as ct,cB as st,G as dt,Y as U,aS as ft}from"./index-08ed677d.js";import{i as mt}from"./index-5362a68f.js";import{V as ht}from"./vuedraggable.umd-a1c90dfc.js";import{C as gt,a as vt}from"./index-9d5a19c2.js";import{_ as yt}from"./index-ffe2e608.js";var Ct={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M840 836H184c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h656c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8zm0-724H184c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h656c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8zM610.8 378c6 0 9.4-7 5.7-11.7L515.7 238.7a7.14 7.14 0 00-11.3 0L403.6 366.3a7.23 7.23 0 005.7 11.7H476v268h-62.8c-6 0-9.4 7-5.7 11.7l100.8 127.5c2.9 3.7 8.5 3.7 11.3 0l100.8-127.5c3.7-4.7.4-11.7-5.7-11.7H548V378h62.8z"}}]},name:"column-height",theme:"outlined"};const bt=Ct;function ve(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?Object(arguments[t]):{},a=Object.keys(n);typeof Object.getOwnPropertySymbols=="function"&&(a=a.concat(Object.getOwnPropertySymbols(n).filter(function(i){return Object.getOwnPropertyDescriptor(n,i).enumerable}))),a.forEach(function(i){St(e,i,n[i])})}return e}function St(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var W=function(t,n){var a=ve({},t,n.attrs);return b(J,ve({},a,{icon:bt}),null)};W.displayName="ColumnHeightOutlined";W.inheritAttrs=!1;const Ot=W,pt={title:String,placement:String,disabled:Boolean},xt=G({name:"EleToolItem",components:{ATooltip:Oe},props:pt,emits:["click"],setup(e,{emit:t}){const n=A(!1),a=r=>{e.disabled||(n.value=r)},i=r=>{n.value=!1,t("click",r)};return P(()=>e.disabled,r=>{r||(n.value=!1)}),{visible:n,updateVisible:a,onClick:i}}}),kt=(e,t)=>{const n=e.__vccOpts||e;for(const[a,i]of t)n[a]=i;return n};function At(e,t,n,a,i,r){const u=O("ATooltip");return T(),H("div",{class:"ele-tool-item",onClick:t[0]||(t[0]=(...c)=>e.onClick&&e.onClick(...c))},[b(u,{title:e.title,visible:e.visible,placement:e.placement,"onUpdate:visible":e.updateVisible},{default:k(()=>[pe(e.$slots,"default")]),_:3},8,["title","visible","placement","onUpdate:visible"])])}const xe=kt(xt,[["render",At]]);var wt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M300 276.5a56 56 0 1056-97 56 56 0 00-56 97zm0 284a56 56 0 1056-97 56 56 0 00-56 97zM640 228a56 56 0 10112 0 56 56 0 00-112 0zm0 284a56 56 0 10112 0 56 56 0 00-112 0zM300 844.5a56 56 0 1056-97 56 56 0 00-56 97zM640 796a56 56 0 10112 0 56 56 0 00-112 0z"}}]},name:"holder",theme:"outlined"};const It=wt;function ye(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?Object(arguments[t]):{},a=Object.keys(n);typeof Object.getOwnPropertySymbols=="function"&&(a=a.concat(Object.getOwnPropertySymbols(n).filter(function(i){return Object.getOwnPropertyDescriptor(n,i).enumerable}))),a.forEach(function(i){zt(e,i,n[i])})}return e}function zt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Y=function(t,n){var a=ye({},t,n.attrs);return b(J,ye({},a,{icon:It}),null)};Y.displayName="HolderOutlined";Y.inheritAttrs=!1;const _t=Y;var Tt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M326 164h-64c-4.4 0-8 3.6-8 8v688c0 4.4 3.6 8 8 8h64c4.4 0 8-3.6 8-8V172c0-4.4-3.6-8-8-8zm444 72.4V164c0-6.8-7.9-10.5-13.1-6.1L335 512l421.9 354.1c5.2 4.4 13.1.7 13.1-6.1v-72.4c0-9.4-4.2-18.4-11.4-24.5L459.4 512l299.2-251.1c7.2-6.1 11.4-15.1 11.4-24.5z"}}]},name:"vertical-right",theme:"outlined"};const Rt=Tt;function Ce(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?Object(arguments[t]):{},a=Object.keys(n);typeof Object.getOwnPropertySymbols=="function"&&(a=a.concat(Object.getOwnPropertySymbols(n).filter(function(i){return Object.getOwnPropertyDescriptor(n,i).enumerable}))),a.forEach(function(i){Pt(e,i,n[i])})}return e}function Pt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var X=function(t,n){var a=Ce({},t,n.attrs);return b(J,Ce({},a,{icon:Rt}),null)};X.displayName="VerticalRightOutlined";X.inheritAttrs=!1;const Lt=X;var Vt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M762 164h-64c-4.4 0-8 3.6-8 8v688c0 4.4 3.6 8 8 8h64c4.4 0 8-3.6 8-8V172c0-4.4-3.6-8-8-8zm-508 0v72.4c0 9.5 4.2 18.4 11.4 24.5L564.6 512 265.4 763.1c-7.2 6.1-11.4 15-11.4 24.5V860c0 6.8 7.9 10.5 13.1 6.1L689 512 267.1 157.9A7.95 7.95 0 00254 164z"}}]},name:"vertical-left",theme:"outlined"};const Et=Vt;function be(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?Object(arguments[t]):{},a=Object.keys(n);typeof Object.getOwnPropertySymbols=="function"&&(a=a.concat(Object.getOwnPropertySymbols(n).filter(function(i){return Object.getOwnPropertyDescriptor(n,i).enumerable}))),a.forEach(function(i){Ft(e,i,n[i])})}return e}function Ft(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ee=function(t,n){var a=be({},t,n.attrs);return b(J,be({},a,{icon:Et}),null)};ee.displayName="VerticalLeftOutlined";ee.inheritAttrs=!1;const Nt=ee,$t={sortName:"sort",orderName:"order"},Bt={dataName:"list",countName:"count"},jt="asc",Dt="desc";function q(e,t){if(typeof t=="function")return t(e);if(t){let n=e;return t.split(".").forEach(a=>{n=n?n[a]:null}),n}}function ke(e){const t=[];return(Array.isArray(e)?e:[e]).forEach(n=>{if(!n||!n.order)return;const a=n.order==="descend";(Array.isArray(n.field)?n.field:[n.field]).forEach(i=>{var r;if(typeof i=="string"&&i){const u=(r=n.column)==null?void 0:r.sorter;t.push({field:i,descend:a,sorter:u,multiple:typeof u=="object"?u.multiple:void 0})}})}),t.sort((n,a)=>{var i,r;return((i=a.multiple)!=null?i:0)-((r=n.multiple)!=null?r:0)})}function Ht(e,t,n,a,i){const r=Ae(e,t),u=r.length;if(i&&n&&a){const c=Math.ceil(u/a);c&&n>c&&(n=c);const m=(n-1)*a,p=m+a,g=r.slice(m,p>u?u:p);return{page:n,data:g,total:u}}else return{page:1,data:r,total:u}}function Ae(e,t){const n=[...e];return ke(t).forEach(a=>{n.sort((i,r)=>{if(typeof a.sorter=="function"){const u=a.sorter(i,r);return a.descend?-u:u}else if(typeof a.sorter=="object"&&typeof a.sorter.compare=="function"){const u=a.sorter.compare(i,r);return a.descend?-u:u}else{const u=i[a.field],c=r[a.field];return u==c?0:a.descend?u<c?1:-1:u<c?-1:1}})}),n}function we(e){const t=[];return e.forEach(n=>{var a;if(!n.hideInTable)if((a=n.children)!=null&&a.length){const i=we(n.children);i.length&&t.push({...n,children:i})}else t.push({...n})}),t}function Kt(e,t,n){const a=Ie(t);return a?$(e,a.data,a.checkedIds,n):we(e)}function F(e){const t=e.key||e.dataIndex;return(Array.isArray(t)?t:[t]).join(".")}function $(e,t,n,a){const i=[];return e&&e.forEach(r=>{var p;const u=F(r),c=t.find(g=>g.id===u);if(c&&!n.includes(u))return;const m=(p=c==null?void 0:c.fixed)!=null?p:r.fixed;if(r.children){const g=$(r.children,t,n,a);g.length&&i.push({...r,fixed:m,children:g})}else i.push({...r,fixed:m})}),a&&i.length&&i.sort((r,u)=>{var c,m;const p=F(r),g=F(u);let f=t.findIndex(S=>S.id===p),v=t.findIndex(S=>S.id===g);if(f===-1&&((c=r.children)!=null&&c.length)){const S=F(r.children[0]);f=t.findIndex(s=>s.id===S)}if(v===-1&&((m=u.children)!=null&&m.length)){const S=F(u.children[0]);v=t.findIndex(s=>s.id===S)}return f===-1&&r.hideInSetting&&r.fixed==="right"&&(f=t.length),r.fixed===!0||r.fixed==="left"?f-=t.length:(r.fixed==="right"||r.hideInSetting&&!r.fixed)&&(f+=t.length),v===-1&&u.hideInSetting&&u.fixed==="right"&&(v=t.length),u.fixed===!0||u.fixed==="left"?v-=t.length:(u.fixed==="right"||u.hideInSetting&&!u.fixed)&&(v+=t.length),f-v}),i}function Se(e,t,n){const a=Ie(n);if(a)return a;const i=[];e&&Z(e,u=>{var c;const m=F(u);m&&!((c=u.children)!=null&&c.length)&&!u.hideInSetting&&i.push({id:m,key:u.key,dataIndex:u.dataIndex,title:u.title||t,checked:!u.hideInTable,fixed:u.fixed})});const r=i.filter(u=>u.checked).map(u=>u.id);return{data:i,checkedIds:r,isAllChecked:i.length>0&&i.length===r.length,isIndeterminate:r.length!==0&&i.length!==r.length}}function Ie(e){if(e)try{const t=localStorage.getItem(ze(e));if(t){const n=JSON.parse(t);if(Array.isArray(n)){const a=n.filter(i=>i.checked).map(i=>i.id);return{data:n,checkedIds:a,isAllChecked:n.length>0&&n.length===a.length,isIndeterminate:a.length!==0&&n.length!==a.length}}}}catch(t){}}function ze(e){return`${e}Cols`}function _e(e){return`${e}Size`}function Mt(e){if(e){const t=localStorage.getItem(_e(e));if(t)return JSON.parse(t)}}const Ut=G({name:"ToolColumns",components:{APopover:We,ACheckbox:gt,ACheckboxGroup:vt,ATooltip:Oe,SettingOutlined:Ye,HolderOutlined:_t,VerticalRightOutlined:Lt,VerticalLeftOutlined:Nt,VueDraggable:ht,EleToolItem:xe},props:{tipTitle:String,tipPlacement:{type:String},title:String,resetText:String,untitledText:String,fixedLeftText:String,fixedRightText:String,columns:{type:Array,required:!0},sortable:{type:Boolean,default:!0},allowFixed:{type:Boolean,default:!0},cacheKey:String},emits:["update:columns"],setup(e,{emit:t}){const n=A([]),a=A([]),i=A(!1),r=A(!1),u=I(()=>{const s=["ele-tool-column"];return e.sortable&&s.push("ele-tool-column-sortable"),s.join(" ")}),c=()=>{n.value.forEach(y=>{y.checked=a.value.includes(y.id)}),i.value=n.value.length>0&&n.value.length===a.value.length,r.value=a.value.length!==0&&n.value.length!==a.value.length;const s=$(e.columns,n.value,a.value,e.sortable);S(),t("update:columns",s)},m=()=>{i.value?a.value=n.value.map(y=>y.id):a.value=[],r.value=!1,n.value.forEach(y=>{y.checked=a.value.includes(y.id)});const s=$(e.columns,n.value,a.value,e.sortable);S(),t("update:columns",s)},p=()=>{const s=Se(e.columns,e.untitledText);n.value=s.data,a.value=s.checkedIds,i.value=s.isAllChecked,r.value=s.isIndeterminate;const y=$(e.columns,s.data,s.checkedIds,e.sortable);S(),t("update:columns",y)},g=()=>{const s=$(e.columns,n.value,a.value,e.sortable);S(),t("update:columns",s)},f=s=>{s.fixed=s.fixed===!0||s.fixed==="left"?!1:"left",g()},v=s=>{s.fixed=s.fixed==="right"?!1:"right",g()},S=()=>{e.cacheKey&&localStorage.setItem(ze(e.cacheKey),JSON.stringify(n.value))};return P(()=>e.columns,s=>{if(s){const y=Se(s,e.untitledText,e.cacheKey);n.value=y.data,a.value=y.checkedIds,i.value=y.isAllChecked,r.value=y.isIndeterminate}},{immediate:!0,deep:!0}),{colList:n,checkedIds:a,isAllChecked:i,isIndeterminate:r,overlayClassName:u,onColumnCheckedChange:c,onColumnCheckAllChange:m,resetColumnChecked:p,onColumnSortChange:g,onItemFixedLeft:f,onItemFixedRight:v}}}),qt=(e,t)=>{const n=e.__vccOpts||e;for(const[a,i]of t)n[a]=i;return n},Jt={class:"ele-tool-column-header"},Gt={class:"ele-tool-column-item-body"},Qt={class:"ele-tool-column-item"},Zt={key:0,class:"ele-tool-column-handle"},Wt={class:"ele-tool-column-item-body"},Yt={key:1,class:"ele-tool-column-fixed"},Xt=["onClick"],en=["onClick"];function tn(e,t,n,a,i,r){const u=O("SettingOutlined"),c=O("ACheckbox"),m=O("HolderOutlined"),p=O("VerticalRightOutlined"),g=O("ATooltip"),f=O("VerticalLeftOutlined"),v=O("VueDraggable"),S=O("ACheckboxGroup"),s=O("APopover"),y=O("EleToolItem");return T(),V(y,{title:e.tipTitle,placement:e.tipPlacement},{default:k(()=>[b(s,{trigger:"click",placement:"bottomRight","arrow-point-at-center":!0,"overlay-class-name":e.overlayClassName},{content:k(()=>[E("div",Jt,[E("div",Gt,[b(c,{checked:e.isAllChecked,"onUpdate:checked":t[0]||(t[0]=h=>e.isAllChecked=h),indeterminate:e.isIndeterminate,onChange:e.onColumnCheckAllChange},{default:k(()=>[D(B(e.title),1)]),_:1},8,["checked","indeterminate","onChange"])]),E("a",{onClick:t[1]||(t[1]=(...h)=>e.resetColumnChecked&&e.resetColumnChecked(...h))},B(e.resetText),1)]),b(S,{value:e.checkedIds,"onUpdate:value":t[3]||(t[3]=h=>e.checkedIds=h),onChange:e.onColumnCheckedChange},{default:k(()=>[b(v,{"item-key":"id",animation:"300",modelValue:e.colList,"onUpdate:modelValue":t[2]||(t[2]=h=>e.colList=h),"set-data":()=>{},"component-data":{class:"ele-tool-column-body"},handle:".ele-tool-column-handle",onChange:e.onColumnSortChange},{item:k(({element:h})=>[E("div",Qt,[e.sortable?(T(),H("div",Zt,[b(m)])):N("",!0),E("div",Wt,[b(c,{value:h.id},{default:k(()=>[D(B(h.title),1)]),_:2},1032,["value"])]),e.allowFixed?(T(),H("div",Yt,[E("div",{class:me(["ele-tool-fixed-item",{active:h.fixed===!0||h.fixed==="left"}]),onClick:R=>e.onItemFixedLeft(h)},[b(g,{title:e.fixedLeftText},{default:k(()=>[b(p)]),_:1},8,["title"])],10,Xt),E("div",{class:me(["ele-tool-fixed-item",{active:h.fixed==="right"}]),onClick:R=>e.onItemFixedRight(h)},[b(g,{title:e.fixedRightText},{default:k(()=>[b(f)]),_:1},8,["title"])],10,en)])):N("",!0)])]),_:1},8,["modelValue","set-data","onChange"])]),_:1},8,["value","onChange"])]),default:k(()=>[b(u)]),_:1},8,["overlay-class-name"])]),_:1},8,["title","placement"])}const nn=qt(Ut,[["render",tn]]),ln=G({name:"TableTools",components:{ADropdown:Xe,ASpace:et,AMenu:tt,AMenuItem:nt,ReloadOutlined:lt,ColumnHeightOutlined:Ot,FullscreenOutlined:at,FullscreenExitOutlined:ot,EleToolItem:xe,ToolColumns:nn},props:{space:{type:String,default:"middle"},size:{type:String,default:"default"},columns:{type:Array,default:()=>[]},tools:{type:Array,default:()=>["reload","size","columns","fullscreen"]},columnsSort:{type:Boolean,default:!0},columnsFixed:{type:Boolean,deault:!0},fullscreen:Boolean,customStyle:Object,cacheKey:String},emits:["reload","update:size","update:columns","update:fullscreen"],setup(e,{emit:t}){const{locale:n}=it({name:"tableTools"}),a=I(()=>{var f;return(f=he(n).sizeOption)!=null?f:{}}),i=I(()=>{var f;return(f=he(n).columnsOption)!=null?f:{}}),r=I(()=>[e.size]),u=I(()=>e.fullscreen?"bottom":"top");return{locale:n,sizeLocale:a,columnsLocale:i,selectedKeys:r,tipsPlacement:u,reload:()=>{t("reload")},updateSize:({key:f})=>{e.cacheKey&&localStorage.setItem(_e(e.cacheKey),JSON.stringify(f)),t("update:size",f)},updateColumns:f=>{t("update:columns",f)},toggleFullscreen:()=>{t("update:fullscreen",!e.fullscreen)}}}}),an=(e,t)=>{const n=e.__vccOpts||e;for(const[a,i]of t)n[a]=i;return n};function on(e,t,n,a,i,r){const u=O("ReloadOutlined"),c=O("EleToolItem"),m=O("ColumnHeightOutlined"),p=O("AMenuItem"),g=O("AMenu"),f=O("ADropdown"),v=O("ToolColumns"),S=O("FullscreenExitOutlined"),s=O("FullscreenOutlined"),y=O("ASpace");return T(),V(y,{size:e.space,class:"ele-tool",style:rt(e.customStyle)},{default:k(()=>[pe(e.$slots,"default"),(T(!0),H(ge,null,ut(e.tools,(h,R)=>(T(),H(ge,null,[h==="reload"?(T(),V(c,{key:"reload"+R,placement:e.tipsPlacement,title:e.locale.refresh,onClick:e.reload},{default:k(()=>[b(u)]),_:2},1032,["placement","title","onClick"])):N("",!0),h==="size"?(T(),V(c,{key:"size"+R,placement:e.tipsPlacement,title:e.locale.size},{default:k(()=>[b(f,{trigger:["click"],"overlay-style":{minWidth:"80px"},placement:"bottomRight"},{overlay:k(()=>[b(g,{"selected-keys":e.selectedKeys,onClick:e.updateSize},{default:k(()=>[b(p,{key:"default"},{default:k(()=>[D(B(e.sizeLocale.medium),1)]),_:1}),b(p,{key:"middle"},{default:k(()=>[D(B(e.sizeLocale.small),1)]),_:1}),b(p,{key:"small"},{default:k(()=>[D(B(e.sizeLocale.mini),1)]),_:1})]),_:1},8,["selected-keys","onClick"])]),default:k(()=>[b(m)]),_:1})]),_:2},1032,["placement","title"])):N("",!0),h==="columns"?(T(),V(v,{key:"columns"+R,columns:e.columns,sortable:e.columnsSort,"allow-fixed":e.columnsFixed,"tip-placement":e.tipsPlacement,"tip-title":e.locale.columns,title:e.columnsLocale.columns,"reset-text":e.columnsLocale.reset,"untitled-text":e.columnsLocale.untitled,"fixed-left-text":e.columnsLocale.fixedLeft,"fixed-right-text":e.columnsLocale.fixedRight,"cache-key":e.cacheKey,"onUpdate:columns":e.updateColumns},null,8,["columns","sortable","allow-fixed","tip-placement","tip-title","title","reset-text","untitled-text","fixed-left-text","fixed-right-text","cache-key","onUpdate:columns"])):N("",!0),h==="fullscreen"?(T(),V(c,{key:"fullscreen"+R,placement:e.tipsPlacement,title:e.locale.fullscreen,onClick:e.toggleFullscreen},{default:k(()=>[e.fullscreen?(T(),V(S,{key:0})):(T(),V(s,{key:1}))]),_:2},1032,["placement","title","onClick"])):N("",!0)],64))),256))]),_:3},8,["size","style"])}const un=an(ln,[["render",on]]),rn={datasource:{type:[Array,Function],required:!0},where:Object,request:Object,response:Object,parseData:Function,ascendValue:String,descendValue:String,selection:Array,current:Object,selectionType:String,needPage:{type:Boolean,default:!0},initLoad:{type:Boolean,default:!0},loading:Boolean,columns:{type:Array,required:!0},currentPage:{type:Number,default:1,validator:e=>e>0},pageSize:{type:Number,default:10,validator:e=>e>0},toolsTheme:String,title:String,subTitle:String,toolkit:{type:Array,default:()=>["reload","size","columns","fullscreen"]},columnsSort:{type:Boolean,default:!0},columnsFixed:{type:Boolean,default:!0},toolbar:{type:Boolean,default:!0},toolStyle:Object,toolClass:String,toolkitStyle:Object,fullZIndex:{type:Number,default:999},autoAmendPage:{type:Boolean,default:!0},lazyLoad:Boolean,hasChildrenColumnName:String,striped:Boolean,height:[String,Number],fullHeight:[String,Number],reloadOnChange:{type:Boolean,default:!0},resizable:Boolean,customStyle:Object,cacheKey:String},cn={hideOnSinglePage:Boolean,pageSizeOptions:{type:Array,default:()=>["10","20","30","40","50","100"]},showLessItems:Boolean,showQuickJumper:{type:Boolean,default:!0},showSizeChanger:{type:Boolean,default:!0},showTotal:{type:Function,default:e=>`共 ${e} 条`},simple:Boolean,position:{type:Array,default:()=>["bottomRight"]}},sn={bordered:Boolean,components:Object,childrenColumnName:{type:String,default:"children"},defaultExpandAllRows:Boolean,defaultExpandedRowKeys:Array,expandedRowKeys:Array,expandedRowRender:Function,expandFixed:{type:[Boolean,String],default:!1},expandIcon:Function,expandRowByClick:Boolean,expandIconColumnIndex:Number,footer:Function,getPopupContainer:Function,locale:Object,rowClassName:Function,rowKey:{type:[String,Function],default:"key"},rowSelection:Object,scroll:Object,showHeader:{type:Boolean,default:!0},showSorterTooltip:{type:[Boolean,Object],default:!0},size:String,sortDirections:{type:Array,default:()=>["ascend","descend"]},sticky:[Object,Boolean],tableLayout:String,indentSize:{type:Number,default:15},rowExpandable:Function,customHeaderRow:Function,customRow:Function,transformCellText:Function},dn={...rn,...cn,...sn},Cn=G({name:"EleProTable",props:dn,emits:["done","update:selection","update:current","columns-change","size-change","fullscreen-change","refresh","expandedRowsChange","change","expand","resizeColumn"],setup(e,{emit:t,slots:n,expose:a}){var ie,ue,re;const{authenticated:i}=ct(),r=st(),u=I(()=>{var l;return(l=r.table)!=null?l:{}});let c=null,m=null,p={};const g=A([]),f=A(e.currentPage),v=A(e.pageSize),S=A(0),s=A(e.loading),y=A([]),h=A((re=(ue=(ie=Mt(e.cacheKey))!=null?ie:e.size)!=null?ue:u.value.size)!=null?re:"middle"),R=A(!1),j=A(""),z=A([]),Te=I(()=>{var l,o;return(((l=f.value)!=null?l:1)-1)*((o=v.value)!=null?o:0)+1}),Re=I(()=>["ele-pro-table",{"ele-pro-table-fullscreen":R.value},{"ele-pro-table-striped":e.striped}]),Pe=I(()=>{const l={zIndex:e.fullZIndex},o=R.value?e.fullHeight:e.height;return o!=null&&(l["--table-body-height"]=o),l}),Le=I(()=>({y:R.value?e.fullHeight:e.height,...e.scroll})),Ve=I(()=>{var l;const o=j.value||((l=e.locale)==null?void 0:l.emptyText);return{...e.locale,emptyText:o}}),Ee=I(()=>e.needPage?{position:e.position,hideOnSinglePage:e.hideOnSinglePage,pageSizeOptions:e.pageSizeOptions,showLessItems:e.showLessItems,showQuickJumper:e.showQuickJumper,showSizeChanger:e.showSizeChanger,showTotal:e.showTotal,simple:e.simple,current:f.value,pageSize:v.value,total:S.value,size:h.value&&["middle","small"].includes(h.value)?"small":void 0}:!1),K=I(()=>{const l=typeof e.current>"u",o=typeof e.selection>"u";if(!(o&&l&&e.selectionType!=="radio"))return e.selectionType||(o?"radio":"checkbox")}),Fe=I(()=>{if(K.value)return{...e.rowSelection,type:K.value,selectedRowKeys:z.value,onChange:Ne}}),Ne=(l,o)=>{z.value=l,t("update:selection",o),t("update:current",o.length?o[0]:null)},L=(l,o)=>{if(!i.value){j.value=ft;return}l&&(l.page&&(f.value=l.page),l.limit&&(v.value=l.limit),l.where&&(p=l.where),l.sorter&&(c=l.sorter),l.filters&&(m=l.filters)),j.value="";const d=Q(),x=oe();if(Array.isArray(e.datasource)){s.value=!0;const{page:C,data:w,total:_}=Ht(e.datasource,c!=null?c:d,f.value,v.value,e.needPage);f.value=C,g.value=w,S.value=_,s.value=!1;const M={data:w,total:_,response:e.datasource};t("done",M,C,_);return}typeof e.datasource=="function"&&(o||(s.value=!0),e.datasource({page:f.value,limit:v.value,where:{...p},orders:ne(d),filters:le(x),sorter:c!=null?c:d,orgFilters:m!=null?m:x,parent:o}).then(C=>{const{data:w,count:_}=$e(C);te(w,_,o,C)}).catch(C=>{te(C==null?void 0:C.message)}))},te=(l,o,d,x)=>{if(typeof l=="string")j.value=l,s.value=!1;else if(Array.isArray(l)){if(d)d[e.childrenColumnName]=l.length?l:null;else{if(e.autoAmendPage&&e.needPage&&!l.length&&o&&f.value&&v.value){const w=Math.ceil(o/v.value);if(w&&f.value>w){f.value=w,L();return}}g.value=l,S.value=o||l.length}s.value=!1;const C={data:g.value,total:S.value,response:x};t("done",C,f.value,S.value,d)}else s.value=!1,j.value="获取数据失败",console.error("datasource 返回的数据错误: ",l)},ne=l=>{var M,ce,se,de;const o={},{sortName:d,orderName:x}={...$t,...r.request,...e.request};if(!d||!x)return o;const C=(ce=(M=e.ascendValue)!=null?M:u.value.ascendValue)!=null?ce:jt,w=(de=(se=e.descendValue)!=null?se:u.value.descendValue)!=null?de:Dt,_=ke(c!=null?c:l);return _.length===1?(o[d]=_[0].field,o[x]=_[0].descend?w:C):_.length&&(o[d]=_.map(fe=>[fe.field,fe.descend?w:C].join(" ")).join(",")),o},le=l=>{const o={},d=m!=null?m:l;return Object.keys(d).forEach(x=>{const C=d[x];C!=null&&(typeof C=="string"?C&&(o[x]=C):Array.isArray(C)?C.length&&(o[x]=C.join(",")):o[x]=C)}),o},$e=l=>{const o=e.parseData?e.parseData(l):l;if(!o||Array.isArray(o))return{data:ae(o)};const{dataName:d,countName:x}={...Bt,...r.response,...e.response};return d?{data:ae(q(o,d)),count:x?q(o,x):0}:{}},ae=l=>!l||!e.lazyLoad?l:l.map(o=>{const d={...o};if(e.childrenColumnName&&!o[e.childrenColumnName])if(e.hasChildrenColumnName){const x=o[e.hasChildrenColumnName];d[e.childrenColumnName]=x?[]:null}else d[e.childrenColumnName]=[];return d}),Q=()=>{const l={};return Z(e.columns,o=>{const d=o.sortOrder||o.defaultSortOrder;typeof o.dataIndex=="string"&&o.dataIndex.length&&d&&(l.field=o.dataIndex,l.order=d)}),l},oe=()=>{const l={};return Z(e.columns,o=>{const d=o.filteredValue||o.defaultFilteredValue;typeof o.dataIndex=="string"&&o.dataIndex.length&&d&&(l[o.dataIndex]=d)}),l},Be=()=>g.value,je=l=>{g.value=l},De=()=>{Array.isArray(e.datasource)?t("refresh"):L()},He=l=>{h.value=l,t("size-change",l)},Ke=l=>{y.value=l,t("columns-change",l)},Me=l=>{R.value=l,t("fullscreen-change",l)},Ue=(l,o,d,x)=>{f.value=l.current,v.value=l.pageSize,c=d,m=o,t("change",l,o,d,x),e.reloadOnChange&&L()},qe=(l,o)=>{t("expand",l,o),l&&e.lazyLoad&&!Array.isArray(e.datasource)&&o.children&&!o.children.length&&L(void 0,o)},Je=l=>{t("expandedRowsChange",l)},Ge=(l,o)=>{e.resizable&&(o.width=l),t("resizeColumn",l,o)},Qe=l=>{const o=Q(),d=oe();l({page:f.value,limit:v.value,where:{...p},orders:ne(o),filters:le(d),sorter:c!=null?c:o,orgFilters:m!=null?m:d})},Ze=(l,o)=>{if(!e.needPage||v.value==null||!Array.isArray(e.datasource))return;const d=Q(),C=Ae(e.datasource,c!=null?c:d).findIndex(_=>_[o]===l),w=Math.floor(C/v.value)+1;f.value!==w&&L({page:w})};return P(()=>e.datasource,()=>{L()},{deep:!0}),P(()=>e.loading,l=>{s.value=l}),P(()=>e.size,l=>{h.value=l}),P(()=>e.columns,l=>{l?y.value=Kt(l,e.cacheKey,e.columnsSort):y.value.length&&(y.value=[])},{immediate:!0,deep:!0}),P(()=>e.selection,l=>{if(K.value==="checkbox")if(l!=null&&l.length){const o=l.map(d=>q(d,e.rowKey));if(o.length!==z.value.length)z.value=o;else for(let d=0;d<o.length;d++)if(!z.value.includes(o[d])){z.value=o;return}}else z.value.length&&(z.value=[])},{immediate:!0,deep:!0}),P(()=>e.current,l=>{if(K.value==="radio")if(l){const o=q(l,e.rowKey);(z.value.length!==1||z.value[0]!==o)&&(z.value=[o])}else z.value.length&&(z.value=[])},{immediate:!0}),P(u,l=>{e.size==null&&l.size!=null&&(h.value=l.size)},{deep:!0}),dt(()=>{e.initLoad&&L({where:e.where})}),a({tableIndex:Te,reload:L,getData:Be,setData:je,doRequest:Qe,pageToByValue:Ze}),()=>{const l=[];return e.toolbar&&l.push(U(mt,{title:e.title,subTitle:e.subTitle,theme:e.toolsTheme,style:e.toolStyle,class:e.toolClass},{default:n.toolbar,action:()=>U(un,{tools:e.toolkit,size:h.value,columns:e.columns,columnsSort:e.columnsSort,columnsFixed:e.columnsFixed,customStyle:e.toolkitStyle,fullscreen:R.value,space:e.toolsTheme==="default"?"small":"middle",cacheKey:e.cacheKey,onReload:De,"onUpdate:size":He,"onUpdate:columns":Ke,"onUpdate:fullscreen":Me},{default:n.toolkit})})),n.default&&n.default().forEach(o=>{l.push(o)}),l.push(U(yt,{bordered:e.bordered,components:e.components,childrenColumnName:e.childrenColumnName,defaultExpandAllRows:e.defaultExpandAllRows,defaultExpandedRowKeys:e.defaultExpandedRowKeys,expandedRowKeys:e.expandedRowKeys,expandedRowRender:e.expandedRowRender,expandFixed:e.expandFixed,expandIcon:e.expandIcon,expandRowByClick:e.expandRowByClick,expandIconColumnIndex:e.expandIconColumnIndex,footer:e.footer,getPopupContainer:e.getPopupContainer,rowClassName:e.rowClassName,rowKey:e.rowKey,showHeader:e.showHeader,showSorterTooltip:e.showSorterTooltip,sortDirections:e.sortDirections,sticky:e.sticky,tableLayout:e.tableLayout,indentSize:e.indentSize,rowExpandable:e.rowExpandable,customHeaderRow:e.customHeaderRow,customRow:e.customRow,transformCellText:e.transformCellText,columns:y.value,dataSource:g.value,loading:s.value,locale:Ve.value,pagination:Ee.value,rowSelection:Fe.value,scroll:Le.value,size:h.value,style:e.customStyle,onChange:Ue,onExpand:qe,onResizeColumn:Ge,onExpandedRowsChange:Je},{...n,toolbar:void 0,toolkit:void 0,default:void 0})),U("div",{class:Re.value,style:Pe.value},l)}}});export{Cn as i};
