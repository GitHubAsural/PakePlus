import{r as B,o as g,c as $,w as c,b as i,e as E,m as N,ar as J,g as M,d as y,j as k,F as C,k as D,t as A,an as G}from"./index-08ed677d.js";import{C as T,_ as L,a as H}from"./index-7b650976.js";/* empty css              *//* empty css              *//* empty css              *//* empty css              */import{i as K}from"./index-5362a68f.js";import{i as P}from"./index-c83262a0.js";import{u as z,w as O,r as R}from"./xlsx-08161fdb.js";import{_ as Q}from"./index-26669222.js";import"./index-dc3e04fd.js";import"./vuedraggable.umd-a1c90dfc.js";import"./index-9d5a19c2.js";import"./Group-db28a0f9.js";import"./createForOfIteratorHelper-a50550d1.js";import"./index-ffe2e608.js";import"./css-aae66f86.js";import"./useMaxLevel-5fff0ff6.js";import"./index-5353e7c4.js";import"./RadioButton-b1164875.js";import"./CaretDownOutlined-5ddc51ec.js";import"./CaretUpOutlined-d8859d1d.js";import"./iconUtil-c5959902.js";import"./DeleteOutlined-a1ce9a16.js";import"./DownloadOutlined-28687348.js";const W={__name:"excel-export",setup(U){const x=B([{key:1,username:"张小三",amount:18,province:"浙江",city:"杭州",zone:"西湖区",street:"西溪街道",address:"西溪花园30栋1单元"},{key:2,username:"李小四",amount:39,province:"江苏",city:"苏州",zone:"姑苏区",street:"丝绸路",address:"天墅之城9幢2单元"},{key:3,username:"王小五",amount:8,province:"江西",city:"南昌",zone:"青山湖区",street:"艾溪湖办事处",address:"中兴和园1幢3单元"},{key:4,username:"赵小六",amount:16,province:"福建",city:"泉州",zone:"丰泽区",street:"南洋街道",address:"南洋村6幢1单元"},{key:5,username:"孙小七",amount:12,province:"湖北",city:"武汉",zone:"武昌区",street:"武昌大道",address:"两湖花园16幢2单元"},{key:6,username:"周小八",amount:11,province:"安徽",city:"黄山",zone:"黄山区",street:"汤口镇",address:"温泉村21号"}]),b=B([{key:"index",width:48,align:"center",fixed:"left",hideInSetting:!0,customRender:({index:a})=>a+1},{title:"用户名",dataIndex:"username",align:"center"},{title:"地址",key:"cityAddress",children:[{title:"省",dataIndex:"province",align:"center"},{title:"市",dataIndex:"city",align:"center"},{title:"区",dataIndex:"zone",align:"center"},{title:"街道",dataIndex:"street",align:"center"},{title:"详细地址",dataIndex:"address",align:"center"}]},{title:"金额",dataIndex:"amount",align:"center"}]),v=B([]),F=()=>{const a=[["用户名","省","市","区","街道","详细地址","金额"]];x.value.forEach(s=>{a.push([s.username,s.province,s.city,s.zone,s.street,s.address,s.amount])});const t="Sheet1",o={SheetNames:[t],Sheets:{}},r=z.aoa_to_sheet(a);o.Sheets[t]=r,r["!cols"]=[{wch:10},{wch:10},{wch:10},{wch:10},{wch:20},{wch:40},{wch:10}],O(o,"用户数据.xlsx")},I=()=>{const a=[["用户名","地址",null,null,null,null,"金额"],[null,"省","市","区","街道","详细地址",null]];x.value.forEach(s=>{a.push([s.username,s.province,s.city,s.zone,s.street,s.address,s.amount])});const t=z.aoa_to_sheet(a);t["!merges"]=[{s:{r:0,c:1},e:{r:0,c:5}},{s:{r:0,c:1},e:{r:0,c:5}},{s:{r:0,c:0},e:{r:1,c:0}},{s:{r:0,c:6},e:{r:1,c:6}}];const o="Sheet1",r={SheetNames:[o],Sheets:{}};r.Sheets[o]=t,O(r,"用户数据.xlsx")},j=()=>{if(v.value.length===0){N.error("请至少选择一条数据");return}const a=[["用户名","省","市","区","街道","详细地址","金额"]];v.value.forEach(r=>{a.push([r.username,r.province,r.city,r.zone,r.street,r.address,r.amount])});const t="Sheet1",o={SheetNames:[t],Sheets:{}};o.Sheets[t]=z.aoa_to_sheet(a),O(o,"用户数据.xlsx")};return(a,t)=>{const o=J,r=M,s=P,d=T;return g(),$(d,{title:"导出 Excel",bordered:!1},{default:c(()=>[i(s,{bordered:"","row-key":"key",columns:b.value,datasource:x.value,"need-page":!1,"tools-theme":"default",selection:v.value,"onUpdate:selection":t[0]||(t[0]=w=>v.value=w),toolkit:["size","columns","fullscreen"],scroll:{x:800}},{toolbar:c(()=>[i(r,null,{default:c(()=>[i(o,{type:"primary",class:"ele-btn-icon",onClick:F},{default:c(()=>[E(" 导出 ")]),_:1}),i(o,{type:"primary",class:"ele-btn-icon",onClick:I},{default:c(()=>[E(" 导出带表头合并 ")]),_:1}),i(o,{type:"primary",class:"ele-btn-icon",onClick:j},{default:c(()=>[E(" 导出选中 ")]),_:1})]),_:1})]),_:1},8,["columns","datasource","selection"])]),_:1})}}},X={style:{overflow:"auto"}},Y={class:"ele-table ele-table-border",style:{"min-width":"max-content"}},Z=y("th",null,null,-1),q={style:{"text-align":"center"}},ee=["colspan","rowspan"],te=y("div",{style:{margin:"16px 0"}},"二维数组格式数据:",-1),oe={style:{"max-height":"300px",padding:"16px",overflow:"auto"}},se=y("div",{style:{margin:"16px 0"}},"JSON格式数据:",-1),re={style:{"max-height":"300px",padding:"16px",overflow:"auto"}},ne={__name:"excel-import",setup(U){const x=B(["A","B","C","D","E","F","G"]),b=B([]),v=B([]),F=t=>{if(!["application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"].includes(t.type))return N.error("只能选择 excel 文件"),!1;if(t.size/1024/1024>20)return N.error("大小不能超过 20MB"),!1;const o=new FileReader;return o.onload=r=>{var u;const s=new Uint8Array((u=r.target)==null?void 0:u.result),d=R(s,{type:"array"}),w=d.SheetNames,m=d.Sheets[w[0]],h=z.sheet_to_json(m,{header:1});let p=[],l=0,f=[];h.forEach(e=>{e.length>l&&(l=e.length);const _={};for(let n=0;n<e.length;n++){const S=a(n);_[S]=e[n],_["__colspan__"+S]=1,_["__rowspan__"+S]=1}p.push(_)});for(let e=0;e<l;e++)f.push(a(e));x.value=f,b.value=p,v.value=h},o.readAsArrayBuffer(t),!1},I=t=>{if(!["application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"].includes(t.type))return N.error("只能选择 excel 文件"),!1;if(t.size/1024/1024>20)return N.error("大小不能超过 20MB"),!1;const o=new FileReader;return o.onload=r=>{var u;const s=new Uint8Array((u=r.target)==null?void 0:u.result),d=R(s,{type:"array"}),w=d.SheetNames,m=d.Sheets[w[0]],h=z.sheet_to_json(m,{header:1});m["!merges"]&&m["!merges"].forEach(e=>{for(let _=e.s.r;_<=e.e.r;_++)for(let n=e.s.c;n<=e.e.c;n++)h[_][n]=h[e.s.r][e.s.c]});let p=[],l=0,f=[];h.forEach(e=>{e.length>l&&(l=e.length);const _={};for(let n=0;n<e.length;n++)_[a(n)]=e[n];p.push(_)});for(let e=0;e<l;e++)f.push(a(e));x.value=f,b.value=p,v.value=h},o.readAsArrayBuffer(t),!1},j=t=>{if(!["application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"].includes(t.type))return N.error("只能选择 excel 文件"),!1;if(t.size/1024/1024>20)return N.error("大小不能超过 20MB"),!1;const o=new FileReader;return o.onload=r=>{var u;const s=new Uint8Array((u=r.target)==null?void 0:u.result),d=R(s,{type:"array"}),w=d.SheetNames,m=d.Sheets[w[0]],h=z.sheet_to_json(m,{header:1});let p=[],l=0,f=[];h.forEach(e=>{e.length>l&&(l=e.length);const _={};for(let n=0;n<e.length;n++)_[a(n)]=e[n];p.push(_)});for(let e=0;e<l;e++)f.push(a(e));m["!merges"]&&m["!merges"].forEach(e=>{for(let n=e.s.r;n<=e.e.r;n++)for(let S=e.s.c;S<=e.e.c;S++){const V=a(S);p[n]["__colspan__"+V]=0,p[n]["__rowspan__"+V]=0}const _=a(e.s.c);p[e.s.r]["__colspan__"+_]=e.e.c-e.s.c+1,p[e.s.r]["__rowspan__"+_]=e.e.r-e.s.r+1}),x.value=f,b.value=p,v.value=h},o.readAsArrayBuffer(t),!1},a=t=>{const o=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"];if(t<o.length)return o[t];const r=parseInt(String(t/o.length)),s=t%o.length;return o[r]+o[s]};return(t,o)=>{const r=J,s=Q,d=M,w=K,m=L,h=H,p=T;return g(),$(p,{title:"导入 Excel",bordered:!1},{default:c(()=>[i(w,{tools:[]},{default:c(()=>[i(d,null,{default:c(()=>[i(s,{"before-upload":F,"show-upload-list":!1,accept:".xls,.xlsx"},{default:c(()=>[i(r,{type:"primary",class:"ele-btn-icon"},{default:c(()=>[E("导入")]),_:1})]),_:1}),i(s,{"before-upload":I,"show-upload-list":!1,accept:".xls,.xlsx"},{default:c(()=>[i(r,{type:"primary",class:"ele-btn-icon"},{default:c(()=>[E("导入拆分合并")]),_:1})]),_:1}),i(s,{"before-upload":j,"show-upload-list":!1,accept:".xls,.xlsx"},{default:c(()=>[i(r,{type:"primary",class:"ele-btn-icon"},{default:c(()=>[E("导入保持合并")]),_:1})]),_:1})]),_:1})]),_:1}),y("div",X,[y("table",Y,[y("thead",null,[y("tr",null,[Z,(g(!0),k(C,null,D(x.value,l=>(g(),k("th",{key:l,style:{"text-align":"center"}},A(l),1))),128))])]),y("tbody",null,[(g(!0),k(C,null,D(b.value,(l,f)=>(g(),k("tr",{key:f},[y("td",q,A(f+1),1),(g(!0),k(C,null,D(x.value,u=>(g(),k(C,null,[l["__colspan__"+u]!==0&&l["__rowspan__"+u]!==0?(g(),k("td",{key:u,colspan:l["__colspan__"+u],rowspan:l["__rowspan__"+u],style:{"text-align":"center"}},A(l[u]),9,ee)):G("",!0)],64))),256))]))),128))])])]),i(h,{gutter:32},{default:c(()=>[i(m,{md:12,xs:24},{default:c(()=>[te,y("pre",oe,A(JSON.stringify(v.value,null,4))+`
          `,1)]),_:1}),i(m,{md:12,xs:24},{default:c(()=>[se,y("pre",re,A(JSON.stringify(b.value,null,4))+`
          `,1)]),_:1})]),_:1})]),_:1})}}},ae={class:"ele-body ele-body-card"},le={name:"ExtensionExcel"},je=Object.assign(le,{setup(U){return(x,b)=>(g(),k("div",ae,[i(W),i(ne)]))}});export{je as default};
