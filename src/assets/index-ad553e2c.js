import{n as T,f as E,bC as H,bJ as M,bK as Q,aP as N,q as C,ag as f,o as c,j as k,c as h,ai as w,aE as $,d as O,b as u,aO as B,an as j,t as W,w as g,aF as F,b5 as z,aD as J,a as G,a3 as X,aJ as K,k as P,aQ as Z,aR as Y,F as L,aS as x,r as S,e as U,m as I,ar as A,aM as ee,aV as te}from"./index-08ed677d.js";import{C as D}from"./index-7b650976.js";/* empty css              */import{_ as q,a as oe}from"./index-c548e08e.js";import{_ as ae,U as se}from"./index-26669222.js";import{_ as ne}from"./index-dc3e04fd.js";import{V as le}from"./vuedraggable.umd-a1c90dfc.js";import"./index-5353e7c4.js";import{R as re,_ as ie}from"./Group-db28a0f9.js";import"./css-aae66f86.js";import"./ZoomOutOutlined-0d16791b.js";import"./DeleteOutlined-a1ce9a16.js";import"./DownloadOutlined-28687348.js";import"./RadioButton-b1164875.js";const ue=T({name:"ImageItem",components:{AImage:q,AProgress:ne,ATooltip:E,CloseOutlined:H,ReloadOutlined:M,FileTextOutlined:Q},props:{item:{type:Object,required:!0},disabled:Boolean,itemStyle:Object,imageStyle:Object},emits:["remove","item-click","retry"],setup(e,{emit:a}){const{locale:n}=N({name:"upload"}),d=C(()=>e.item.status?{uploading:n.value.uploading,exception:n.value.exception}[e.item.status]:""),m=C(()=>!!(e.item.status&&["uploading","exception"].includes(e.item.status))),l=C(()=>e.item.status?{exception:"exception"}[e.item.status]:void 0);return{locale:n,statusText:d,progressVisible:m,progressStatus:l,onRemove:()=>{a("remove")},onItemClick:()=>{a("item-click")},onRetry:()=>{a("retry")}}}}),de=(e,a)=>{const n=e.__vccOpts||e;for(const[d,m]of a)n[d]=m;return n},ce=["title"],me={key:3,class:"ele-image-upload-progress"},pe={class:"ele-image-upload-text"},ge={key:0,class:"ele-image-upload-retry"},ve={key:4,class:"ele-image-upload-mask"};function fe(e,a,n,d,m,l){const s=f("AImage"),r=f("FileTextOutlined"),t=f("CloseOutlined"),i=f("AProgress"),p=f("ReloadOutlined"),b=f("ATooltip");return c(),k("div",{style:w(e.itemStyle),class:F(["ele-image-upload-item",{"ele-draggable":!e.disabled}]),onClick:a[1]||(a[1]=(...y)=>e.onItemClick&&e.onItemClick(...y))},[e.item.url?(c(),h(s,{key:0,width:"100%",height:"100%",src:e.item.url,alt:e.item.name,style:w(e.imageStyle),preview:!1},null,8,["src","alt","style"])):$(e.$slots,"image",{key:1,item:e.item},()=>[O("div",{class:"ele-image-upload-thumbnail",title:e.item.name},[u(r)],8,ce)]),e.disabled?j("",!0):(c(),k("div",{key:2,class:"ele-image-upload-close",onClick:a[0]||(a[0]=B((...y)=>e.onRemove&&e.onRemove(...y),["stop"]))},[u(t)])),e.progressVisible?(c(),k("div",me,[$(e.$slots,"progress",{item:e.item},()=>[O("div",pe,W(e.statusText),1),u(i,{"show-info":!1,percent:e.item.progress,status:e.progressStatus},null,8,["percent","status"]),e.item.status==="exception"?(c(),k("div",ge,[u(b,{title:e.locale.retry},{default:g(()=>[u(p,{onClick:B(e.onRetry,["stop"])},null,8,["onClick"])]),_:1},8,["title"])])):j("",!0)])])):(c(),k("div",ve))],6)}const _e=de(ue,[["render",fe]]),ye={value:{type:Array,required:!0},disabled:Boolean,preview:{type:Boolean,default:!0},itemStyle:Object,buttonStyle:Object,imageStyle:Object,customStyle:Object,customClass:String,beforeUpload:Function,beforeRemove:Function,uploadHandler:Function,removeHandler:Function,autoUpload:{type:Boolean,default:!0},limit:Number,multiple:Boolean,drag:Boolean,accept:{type:String,default:"image/png,image/jpeg"},directory:Boolean},be=T({name:"EleImageUpload",components:{VueDraggable:le,AUpload:ae,AUploadDragger:se,AImagePreviewGroup:oe,AImage:q,PlusOutlined:z,ImageItem:_e},props:ye,emits:["update:value","remove","item-click","upload","drag-reject"],setup(e,{emit:a}){const{authenticated:n}=J(),d=G({current:0,visible:!1,onVisibleChange:o=>{d.visible=o}}),m=C(()=>{const o=[];return e.itemStyle&&o.push(e.itemStyle),e.buttonStyle&&o.push(e.buttonStyle),o}),l=C(()=>!e.disabled&&!(typeof e.limit=="number"&&e.limit>0&&e.value!=null&&e.value.length>=e.limit)),s=o=>{a("update:value",o)},r=({file:o})=>{if(!n.value){console.warn(x);return}if(!l.value)return;if(typeof e.uploadHandler=="function"){e.uploadHandler(o);return}const _={file:o,uid:o.uid,name:o.name,progress:0,status:void 0};o.type.startsWith("image")&&(_.url=window.URL.createObjectURL(o)),typeof e.beforeUpload=="function"?Promise.resolve(e.beforeUpload(o)).then(R=>{R!==!1&&t(_)}).catch(R=>{R&&console.error(R)}):t(_)},t=o=>{s(e.value==null?[o]:e.value.concat([o])),e.autoUpload&&a("upload",o)},i=o=>{if(typeof e.removeHandler=="function"){e.removeHandler(o);return}typeof e.beforeRemove=="function"?Promise.resolve(e.beforeRemove(o)).then(_=>{_!==!1&&p(o)}).catch(()=>{}):p(o)},p=o=>{s(e.value.filter(_=>_!==o)),a("remove",o)},b=o=>{if(e.preview&&o.url&&e.value!=null){const _=e.value.filter(R=>!!R.url).indexOf(o);_!==-1&&(d.current=_,d.visible=!0)}a("item-click",o)},y=o=>{a("upload",o)},v=o=>{a("drag-reject",o)};return X(()=>{d.visible=!1}),{previewOption:d,uploadButtonStyle:m,uploadVisible:l,updateValue:s,onUpload:r,onRemove:i,onItemClick:b,onRetry:y,onDragReject:v}}}),ke=(e,a)=>{const n=e.__vccOpts||e;for(const[d,m]of a)n[d]=m;return n},he={style:{display:"none"}};function Ie(e,a,n,d,m,l){const s=f("ImageItem"),r=f("PlusOutlined"),t=f("AUploadDragger"),i=f("AUpload"),p=f("AImage"),b=f("AImagePreviewGroup"),y=f("VueDraggable");return c(),h(y,{"item-key":"uid",animation:300,"model-value":e.value,draggable:".ele-draggable",class:F(["ele-image-upload-list",{"ele-image-upload-disabled":e.disabled},e.customClass]),style:w(e.customStyle),"set-data":()=>{},"onUpdate:modelValue":e.updateValue},{item:g(({element:v})=>[u(s,{item:v,disabled:e.disabled,"item-style":e.itemStyle,"image-style":e.imageStyle,onItemClick:o=>e.onItemClick(v),onRemove:o=>e.onRemove(v),onRetry:o=>e.onRetry(v)},K({_:2},[P(Object.keys(e.$slots),o=>({name:o,fn:g(_=>[$(e.$slots,o,Z(Y(_||{})))])}))]),1032,["item","disabled","item-style","image-style","onItemClick","onRemove","onRetry"])]),footer:g(()=>[e.uploadVisible?(c(),k("div",{key:0,style:w(e.uploadButtonStyle),class:"ele-image-upload-item ele-image-upload-button"},[e.drag?(c(),h(t,{key:0,accept:e.accept,multiple:e.multiple,directory:e.directory,"show-upload-list":!1,"custom-request":e.onUpload,onReject:e.onDragReject},{default:g(()=>[$(e.$slots,"icon",{},()=>[u(r,{class:"ele-image-upload-icon"})])]),_:3},8,["accept","multiple","directory","custom-request","onReject"])):(c(),h(i,{key:1,accept:e.accept,multiple:e.multiple,directory:e.directory,"show-upload-list":!1,"custom-request":e.onUpload},{default:g(()=>[$(e.$slots,"icon",{},()=>[u(r,{class:"ele-image-upload-icon"})])]),_:3},8,["accept","multiple","directory","custom-request"]))],4)):j("",!0),O("div",he,[e.previewOption.visible?(c(),h(b,{key:0,preview:e.previewOption},{default:g(()=>[(c(!0),k(L,null,P(e.value,v=>(c(),k(L,null,[v.url?(c(),h(p,{key:v.uid,src:v.url},null,8,["src"])):j("",!0)],64))),256))]),_:1},8,["preview"])):j("",!0)])]),_:3},8,["model-value","class","style","set-data","onUpdate:modelValue"])}const V=ke(be,[["render",Ie]]);const Oe={class:"ele-cell"},Re=O("div",{style:{"line-height":"22px"}},[O("em"),U("禁用:")],-1),Ue={class:"ele-cell-content"},Ce={__name:"demo-basic",setup(e){const a=S([{uid:1,url:"https://cdn.eleadmin.com/20200609/c184eef391ae48dba87e3057e70238fb.jpg",status:"done"},{uid:2,url:"https://cdn.eleadmin.com/20200610/WLXm7gp1EbLDtvVQgkeQeyq5OtDm00Jd.jpg",status:"done"},{uid:3,url:"https://cdn.eleadmin.com/20200609/f6bc05af944a4f738b54128717952107.jpg",status:"done"}]),n=S(!1),d=()=>{console.log("data:",a.value),I.success("数据已打印在控制台")},m=r=>{var i;const t=(i=a.value.find(p=>p.uid===r.uid))!=null?i:r;if(console.log("item:",t),a.value.length!==5){t.status="uploading",t.progress=20;const p=setInterval(()=>{t.progress==null?t.progress=20:t.progress+=20,t.progress===100&&(t.status="done",clearInterval(p))},1e3)}else t.status="uploading",t.progress==null?t.progress=20:t.progress<80&&(t.progress+=20),setTimeout(()=>{t.status="exception",I.error("上传失败, 服务器繁忙")},2e3)},l=r=>{if(!r.type.startsWith("image"))return I.error("只能选择图片"),!1;if(r.size/1024/1024>2)return I.error("大小不能超过 2MB"),!1},s=r=>{console.log("item-click:",r)};return(r,t)=>{const i=V,p=A,b=re,y=ie,v=D;return c(),h(v,{title:"基础示例",bordered:!1},{default:g(()=>[u(i,{value:a.value,"onUpdate:value":t[0]||(t[0]=o=>a.value=o),limit:8,disabled:n.value,"before-upload":l,drag:!0,onUpload:m,onItemClick:s},null,8,["value","disabled"]),O("div",Oe,[u(p,{type:"primary",onClick:d},{default:g(()=>[U("获取数据")]),_:1}),Re,O("div",Ue,[u(y,{value:n.value,"onUpdate:value":t[1]||(t[1]=o=>n.value=o)},{default:g(()=>[u(b,{value:!1},{default:g(()=>[U("否")]),_:1}),u(b,{value:!0},{default:g(()=>[U("是")]),_:1})]),_:1},8,["value"])])])]),_:1})}}},$e={class:"ele-cell"},je={__name:"demo-advanced",setup(e){const a=S([{uid:1,url:"https://cdn.eleadmin.com/20200609/c184eef391ae48dba87e3057e70238fb.jpg",status:"done"},{uid:2,url:"https://cdn.eleadmin.com/20200610/WLXm7gp1EbLDtvVQgkeQeyq5OtDm00Jd.jpg",status:"done"},{uid:3,url:"https://cdn.eleadmin.com/20200609/f6bc05af944a4f738b54128717952107.jpg",status:"done"}]),n=S(!1),d=()=>{if(l()){s();return}n.value=!0,a.value.forEach(t=>{t.status||m(t)})},m=t=>{t.progress==null?t.progress=20:t.progress+=20,t.status="uploading";const i=setInterval(()=>{t.progress==null?t.progress=20:t.progress+=20,t.progress===100&&(t.status="done",clearInterval(i),l()&&s())},Math.round(Math.random()*2500)+500)},l=()=>!a.value.some(t=>t.status!=="done"),s=()=>{I.success("已全部上传完毕"),console.log("data:",a.value),n.value=!1},r=()=>new Promise((t,i)=>{ee.confirm({title:"提示",content:"确定要删除吗?",icon:u(te),maskClosable:!0,onOk:()=>{t()},onCancel:()=>{i()}})});return(t,i)=>{const p=V,b=A,y=D;return c(),h(y,{title:"手动上传",bordered:!1},{default:g(()=>[u(p,{value:a.value,"onUpdate:value":i[0]||(i[0]=v=>a.value=v),"auto-upload":!1,"before-remove":r},null,8,["value"]),O("div",$e,[u(b,{type:"primary",loading:n.value,onClick:d},{default:g(()=>[U(" 提交 ")]),_:1},8,["loading"])])]),_:1})}}},Se={__name:"demo-multiple",setup(e){const a=S([{uid:1,url:"https://cdn.eleadmin.com/20200609/c184eef391ae48dba87e3057e70238fb.jpg",status:"done"},{uid:2,url:"https://cdn.eleadmin.com/20200610/WLXm7gp1EbLDtvVQgkeQeyq5OtDm00Jd.jpg",status:"done"},{uid:3,url:"https://cdn.eleadmin.com/20200609/f6bc05af944a4f738b54128717952107.jpg",status:"done"}]),n=()=>{console.log("data:",a.value),I.success("数据已打印在控制台")},d=l=>{const s={file:l,uid:l.uid,name:l.name,progress:0,status:void 0};if(!l.type.startsWith("image")){I.error("只能选择图片");return}if(l.size/1024/1024>2){I.error("大小不能超过 2MB");return}s.url=window.URL.createObjectURL(l),a.value.push(s),m(s)},m=l=>{var t;const s=(t=a.value.find(i=>i.uid===l.uid))!=null?t:l;console.log("item:",s),s.status="uploading",s.progress=20;const r=setInterval(()=>{s.progress==null?s.progress=20:s.progress+=20,s.progress===100&&(s.status="done",clearInterval(r))},1e3)};return(l,s)=>{const r=V,t=A,i=D;return c(),h(i,{title:"支持多选",bordered:!1},{default:g(()=>[u(r,{value:a.value,"onUpdate:value":s[0]||(s[0]=p=>a.value=p),limit:8,drag:!0,multiple:!0,"upload-handler":d,onUpload:m},null,8,["value"]),u(t,{type:"primary",onClick:n},{default:g(()=>[U("获取数据")]),_:1})]),_:1})}}},we={class:"ele-body ele-body-card"},Ae={name:"ExtensionUpload"},ze=Object.assign(Ae,{setup(e){return(a,n)=>(c(),k("div",we,[u(Ce),u(je),u(Se)]))}});export{ze as default};
