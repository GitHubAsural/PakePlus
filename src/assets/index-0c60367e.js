import{n as U,q as T,Y as u,am as fe,aO as z,o as b,j as O,aF as P,aD as Fe,aP as Oe,a as q,ag as ne,c as D,aJ as le,k as G,w as k,aE as ce,aQ as ie,aR as se,d as x,ai as pe,aS as Te,b as h,A as De,s as V,r as I,aG as _e,E as ge,u as C,m as A,ax as ve,aw as ye,az as ke,aq as be,_ as Z,$ as Ee,a0 as Be,aT as je,F as R,aU as X,aM as xe,aV as Ce,ar as Me,g as Le,aW as Ue,p as J,i as Q,an as L,aX as oe,t as ae,e as Ne,aI as ze,ak as Pe,aY as Ve,al as Ge,ap as Re,aZ as qe}from"./index-08ed677d.js";import{C as He}from"./index-7b650976.js";import{i as We}from"./index-5362a68f.js";import{_ as Ye}from"./index-26669222.js";import"./index-dc3e04fd.js";import{u as Xe}from"./index-64ce0da4.js";import{U as Ze}from"./UploadOutlined-1d86f541.js";import{M as Je}from"./MenuOutlined-2520b6c6.js";import{D as Ie}from"./DeleteOutlined-a1ce9a16.js";import{_ as Qe,a as Ke}from"./index-c548e08e.js";import{D as et}from"./DownloadOutlined-28687348.js";import{E as tt}from"./EditOutlined-44a63741.js";import"./css-aae66f86.js";import"./ZoomOutOutlined-0d16791b.js";const re=U({name:"FileGridItem",props:{item:{type:Object,required:!0},checkbox:Boolean,selection:Array,icons:Array},emits:["item-click","item-check-change"],setup(e,{emit:t,slots:c}){const r=T(()=>e.item&&Array.isArray(e.selection)&&e.selection.includes(e.item)),a=T(()=>{var _,d,i;if(e.item.thumbnail)return e.item.thumbnail;if(e.icons)return e.item.isDirectory?(_=e.icons.find(o=>o.type==="dir"))==null?void 0:_.icon:((d=e.icons.find(o=>{var m;return!!((m=o.types)!=null&&m.find(y=>{var n;return!!((n=e.item.name)!=null&&n.endsWith(y))}))}))==null?void 0:d.icon)||((i=e.icons.find(o=>o.type==="file"))==null?void 0:i.icon)}),f=()=>{t("item-click",e.item)},v=()=>{t("item-check-change",e.item)};return()=>{const _=c["context-menu"],d=[],i=u("div",{class:"ele-file-list-item-body"},[u("div",{class:"ele-file-list-item-icon"},[u("img",{src:a.value,class:{"ele-file-list-item-icon-image":!!e.item.thumbnail}})]),u("div",{class:"ele-file-list-item-title",title:e.item.name},e.item.name)]);return _?d.push(u(fe,{trigger:["contextmenu"],overlayClassName:"ele-file-item-context-menu"},{default:()=>[i],overlay:()=>_({item:e.item})})):d.push(i),e.checkbox&&d.push(u("div",{class:"ele-file-list-item-check",onClick:z(v,["stop"])},[u("i",{class:"ele-file-icon-check checked"})])),u("div",{class:["ele-file-list-item",{checked:r.value}],onClick:z(f,["stop"])},d)}}}),nt=U({name:"FileGrid",components:{FileGridItem:re},props:{data:Array,icons:Array,selection:Array,checkbox:Boolean,checked:Boolean,indeterminate:Boolean,total:Number,totalText:String,checkAllText:String},emits:["check-all-change","item-click","item-check-change"],setup(e,{emit:t,slots:c}){const r=T(()=>["ele-file-list-check ele-file-icon-check",{checked:e.checked},{indeterminate:e.indeterminate}]),a=()=>{t("check-all-change")},f=_=>{t("item-click",_)},v=_=>{t("item-check-change",_)};return()=>{var _,d;const i=[];return e.checkbox&&i.push(u("div",{class:"ele-file-list-header"},[u("div",{class:"ele-file-list-check-group",onClick:z(a,["stop"])},[u("i",{class:r.value}),u("div",{},e.total?(_=e.totalText)==null?void 0:_.replace(/{total}/g,String(e.total)):e.checkAllText)])])),i.push(u("div",{class:"ele-file-list-body"},(d=e.data)==null?void 0:d.map((o,m)=>u(re,{key:m,item:o,icons:e.icons,checkbox:e.checkbox,selection:e.selection,"onItem-click":f,"onItem-check-change":v},c)))),u("div",{class:"ele-file-list"},i)}}}),lt=U({name:"FileSort",props:{sort:String,order:String,name:{type:String,required:!0}},setup(e){return{classes:T(()=>["ele-file-list-table-item-sort",{"ele-file-list-sort-asc":e.name===e.sort&&e.order==="asc"},{"ele-file-list-sort-desc":e.name===e.sort&&e.order==="desc"}])}}}),ct=(e,t)=>{const c=e.__vccOpts||e;for(const[r,a]of t)c[r]=a;return c};function it(e,t,c,r,a,f){return b(),O("i",{class:P(e.classes)},null,2)}const Y=ct(lt,[["render",it]]),de=U({name:"FileTableItem",props:{item:{type:Object,required:!0},checkbox:Boolean,selection:Array,icons:Array,columns:Array},emits:["item-click","item-check-change"],setup(e,{emit:t,slots:c}){const r=T(()=>e.item&&Array.isArray(e.selection)&&e.selection.includes(e.item)),a=T(()=>{var _,d,i;if(e.icons)return e.item.isDirectory?(_=e.icons.find(o=>o.type==="dir"))==null?void 0:_.icon:((d=e.icons.find(o=>{var m;return!!((m=o.types)!=null&&m.find(y=>{var n;return!!((n=e.item.name)!=null&&n.endsWith(y))}))}))==null?void 0:d.icon)||((i=e.icons.find(o=>o.type==="file"))==null?void 0:i.icon)}),f=()=>{t("item-click",e.item)},v=()=>{t("item-check-change",e.item)};return()=>{var _;const d=c["context-menu"],i=[];e.checkbox&&i.push(u("div",{class:"ele-file-list-table-item-check-group"},[u("i",{class:["ele-file-icon-check",{checked:r.value}],onClick:z(v,["stop"])})]));const o=[u("div",{class:"ele-file-list-table-item-icon"},[u("img",{src:a.value,alt:e.item.name,class:"ele-file-list-table-item-icon-image",onClick:f}),u("div",{class:"ele-file-list-table-item-title",title:e.item.name,onClick:f},e.item.name)])],m=c.tool;m&&o.push(u("div",{class:"ele-file-list-table-item-tool-group"},m({item:e.item}))),i.push(u("div",{class:"ele-file-list-table-item-name"},o)),(_=e.columns)==null||_.forEach(n=>{var p;const s=(p=e.item)==null?void 0:p[n.prop],l=n.slot?c[n.slot]:void 0;i.push(u("div",{key:n.prop,style:n.style,class:"ele-file-list-table-item-col"},l?l({item:e.item,col:n}):s==null?void 0:String(s)))});const y=u("div",{class:"ele-file-list-table-item-body"},i);return u("div",{class:["ele-file-list-table-item",{checked:r.value}]},[d?u(fe,{trigger:["contextmenu"],overlayClassName:"ele-file-item-context-menu"},{default:()=>[y],overlay:()=>d({item:e.item})}):y])}}}),st=U({name:"FileTable",components:{FileSort:Y,FileTableItem:de},props:{data:Array,icons:Array,selection:Array,checkbox:Boolean,checked:Boolean,indeterminate:Boolean,total:Number,totalText:String,checkAllText:String,nameText:String,sizeText:String,timeText:String,sort:{type:[String,Boolean],default:!1},order:String,columns:Array},emits:["check-all-change","item-click","item-check-change","sort-change"],setup(e,{emit:t,slots:c}){const r=T(()=>["ele-file-list-table-item-check ele-file-icon-check",{checked:e.checked},{indeterminate:e.indeterminate}]),a=T(()=>e.columns?e.columns:[{title:e.sizeText,prop:"length",style:{width:"120px",flexShrink:0}},{title:e.timeText,prop:"updateTime",style:{width:"180px",flexShrink:0}}]),f=()=>{t("check-all-change")},v=i=>{t("item-click",i)},_=i=>{t("item-check-change",i)},d=i=>{t("sort-change",i)};return()=>{var i;const o=[],m=[];if(e.checkbox){m.push(u("div",{class:"ele-file-list-table-item-check-group"},[u("i",{class:r.value,onClick:z(f,["stop"])})]));const y=[u("span",{},e.nameText)];typeof e.sort=="string"&&y.push(u(Y,{sort:e.sort,order:e.order,name:"name"})),m.push(u("div",{class:"ele-file-list-table-item-name",onClick:()=>d("name")},y)),a.value.forEach(n=>{const p=n.headerSlot?c[n.headerSlot]:void 0,s=[u("span",{},p?p({col:n}):n.title)];typeof e.sort=="string"&&s.push(u(Y,{sort:e.sort,order:e.order,name:n.prop})),m.push(u("div",{key:n.prop,style:n.headStyle||n.style,class:"ele-file-list-table-item-col",onClick:()=>d(n.prop)},s))})}return o.push(u("div",{class:"ele-file-list-table-header"},[u("div",{class:"ele-file-list-table-item"},[u("div",{class:"ele-file-list-table-item-body"},[m])])])),o.push(u("div",{class:"ele-file-list-table-body"},(i=e.data)==null?void 0:i.map((y,n)=>u(de,{key:n,item:y,icons:e.icons,checkbox:e.checkbox,selection:e.selection,columns:a.value,"onItem-click":v,"onItem-check-change":_},c)))),u("div",{class:"ele-file-list-table"},o)}}}),ot=[{icon:"https://cdn.eleadmin.com/20200609/ic_file_misc.png",type:"file"},{icon:"https://cdn.eleadmin.com/20200609/ic_file_folder.png",type:"dir"},{icon:"https://cdn.eleadmin.com/20200609/ic_file_code.png",types:[".java",".js",".css",".vue",".ts",".tsx",".scss",".less",".c",".cpp",".cs",".jsp",".php",".asp",".py",".go",".kt",".lua"]},{icon:"https://cdn.eleadmin.com/20200609/ic_file_htm.png",types:[".html",".htm"]},{icon:"https://cdn.eleadmin.com/20200609/ic_file_text.png",types:[".txt"]},{icon:"https://cdn.eleadmin.com/20200609/ic_file_pdf.png",types:[".pdf"]},{icon:"https://cdn.eleadmin.com/20200609/ic_file_word.png",types:[".doc",".docx"]},{icon:"https://cdn.eleadmin.com/20200609/ic_file_excel.png",types:[".xls",".xlsx"]},{icon:"https://cdn.eleadmin.com/20200609/ic_file_ppt.png",types:[".ppt",".pptx"]},{icon:"https://cdn.eleadmin.com/20200609/ic_file_visio.png",types:[".vsd"]},{icon:"https://cdn.eleadmin.com/20200609/ic_file_ps.png",types:[".psd"]},{icon:"https://cdn.eleadmin.com/20200609/ic_file_cad.png",types:[".dwg"]},{icon:"https://cdn.eleadmin.com/20200609/ic_file_flash.png",types:[".swf"]},{icon:"https://cdn.eleadmin.com/20200609/ic_file_music.png",types:[".mp3",".wav"]},{icon:"https://cdn.eleadmin.com/20200609/ic_file_video.png",types:[".mp4",".rmvb",".flv",".avi",".3gp"]},{icon:"https://cdn.eleadmin.com/20200609/ic_file_picture.png",types:[".png",".jpg",".jpeg",".gif",".bmp"]},{icon:"https://cdn.eleadmin.com/20200609/ic_file_fonts.png",types:[".ttf",".woff"]},{icon:"https://cdn.eleadmin.com/20200609/ic_file_bt.png",types:[".torrent"]},{icon:"https://cdn.eleadmin.com/20200609/ic_file_android.png",types:[".apk"]},{icon:"https://cdn.eleadmin.com/20200609/ic_file_exe.png",types:[".exe"]},{icon:"https://cdn.eleadmin.com/20200609/ic_file_ipa.png",types:[".ipa",".dmg"]},{icon:"https://cdn.eleadmin.com/20200609/ic_file_zip.png",types:[".zip",".rar",".7z"]}],at=[{icon:"https://cdn.eleadmin.com/20200609/ic_file_misc_sm.png",type:"file"},{icon:"https://cdn.eleadmin.com/20200609/ic_file_folder_sm.png",type:"dir"},{icon:"https://cdn.eleadmin.com/20200609/ic_file_code_sm.png",types:[".java",".js",".css",".vue",".ts",".tsx",".scss",".less",".c",".cpp",".cs",".jsp",".php",".asp",".py",".go",".kt",".lua"]},{icon:"https://cdn.eleadmin.com/20200609/ic_file_htm_sm.png",types:[".html",".htm"]},{icon:"https://cdn.eleadmin.com/20200609/ic_file_text_sm.png",types:[".txt"]},{icon:"https://cdn.eleadmin.com/20200609/ic_file_pdf_sm.png",types:[".pdf"]},{icon:"https://cdn.eleadmin.com/20200609/ic_file_word_sm.png",types:[".doc",".docx"]},{icon:"https://cdn.eleadmin.com/20200609/ic_file_excel_sm.png",types:[".xls",".xlsx"]},{icon:"https://cdn.eleadmin.com/20200609/ic_file_ppt_sm.png",types:[".ppt",".pptx"]},{icon:"https://cdn.eleadmin.com/20200609/ic_file_visio_sm.png",types:[".vsd"]},{icon:"https://cdn.eleadmin.com/20200609/ic_file_ps_sm.png",types:[".psd"]},{icon:"https://cdn.eleadmin.com/20200609/ic_file_cad_sm.png",types:[".dwg"]},{icon:"https://cdn.eleadmin.com/20200609/ic_file_flash_sm.png",types:[".swf"]},{icon:"https://cdn.eleadmin.com/20200609/ic_file_music_sm.png",types:[".mp3",".wav"]},{icon:"https://cdn.eleadmin.com/20200609/ic_file_video_sm.png",types:[".mp4",".rmvb",".flv",".avi",".3gp"]},{icon:"https://cdn.eleadmin.com/20200609/ic_file_picture_sm.png",types:[".png",".jpg",".jpeg",".gif",".bmp"]},{icon:"https://cdn.eleadmin.com/20200609/ic_file_fonts_sm.png",types:[".ttf",".woff"]},{icon:"https://cdn.eleadmin.com/20200609/ic_file_bt_sm.png",types:[".torrent"]},{icon:"https://cdn.eleadmin.com/20200609/ic_file_android_sm.png",types:[".apk"]},{icon:"https://cdn.eleadmin.com/20200609/ic_file_exe_sm.png",types:[".exe"]},{icon:"https://cdn.eleadmin.com/20200609/ic_file_ipa_sm.png",types:[".ipa",".dmg"]},{icon:"https://cdn.eleadmin.com/20200609/ic_file_zip_sm.png",types:[".zip",".rar",".7z"]}],rt={data:{type:Array,required:!0},checked:Array,grid:{type:Boolean,default:!0},sort:{type:[String,Boolean],default:!1},order:String,icons:{type:Array,default:()=>ot},smIcons:{type:Array,default:()=>at},columns:Array},me=".ele-file-list-body>.ele-file-list-item",ue=".ele-file-list-table-body>.ele-file-list-table-item",dt=U({name:"EleFileList",components:{FileGrid:nt,FileTable:st},props:rt,emits:["item-click","sort-change","update:checked"],setup(e,{emit:t}){const{authenticated:c}=Fe(),{locale:r}=Oe({name:"fileList"}),a=q({left:"0px",top:"0px",width:"0px",height:"0px",display:"none"}),f=T(()=>Array.isArray(e.checked)),v=T(()=>{var n,p,s;return!!((n=e.data)!=null&&n.length)&&((p=e.checked)==null?void 0:p.length)===((s=e.data)==null?void 0:s.length)}),_=T(()=>{var n,p;return!!((n=e.checked)!=null&&n.length&&e.checked.length!==((p=e.data)==null?void 0:p.length))});return{locale:r,selectorStyle:a,checkbox:f,allChecked:v,indeterminate:_,checkAllChange:()=>{v.value||e.data==null||!e.data.length?t("update:checked",[]):t("update:checked",e.data.slice())},itemCheckChange:n=>{var w;var p,s,l;const g=(w=(p=e.checked)==null?void 0:p.indexOf(n))!=null?w:-1;if(g===-1)t("update:checked",(s=e.checked)==null?void 0:s.concat([n]));else{const $=(l=e.checked)==null?void 0:l.slice(0,g).concat(e.checked.slice(g+1,e.checked.length));t("update:checked",$)}},onItemClick:n=>{if(!c.value){console.warn(Te);return}t("item-click",n)},onSortChange:n=>{typeof e.sort=="string"&&t("sort-change",{sort:n,order:e.order&&n===e.sort?{asc:"desc",desc:""}[e.order]:"asc"})},onMousedown:n=>{if(!f.value)return;const p=n.clientX,s=n.clientY,l=n.currentTarget,g=l.getBoundingClientRect(),w=S=>{const M=Math.max(S.clientX,g.left),j=Math.max(S.clientY,g.top),B=Math.min(M,p)-g.left,F=Math.min(j,s)-g.top,N=Math.min(Math.abs(M-p),l.clientWidth-B),W=Math.min(Math.abs(j-s),l.clientHeight-F),Se={left:B+"px",top:F+"px",width:N+"px",height:W+"px",display:"block"};Object.assign(a,Se);const te=l.querySelectorAll(e.grid?me:ue);if(N<6||W<6){Array.from(te).forEach(E=>{E.classList.remove("active")});return}n.stopPropagation(),n.preventDefault(),S.stopPropagation(),S.preventDefault(),Array.from(te).forEach(E=>{const Ae=E.offsetLeft+E.clientWidth,$e=E.offsetTop+E.clientHeight;Ae>B&&$e>F&&E.offsetLeft<B+N&&E.offsetTop<F+W?E.classList.add("active"):E.classList.remove("active")})},$=()=>{a.display="none";const S=[],M=l.querySelectorAll(e.grid?me:ue);Array.from(M).forEach((j,B)=>{j.classList.contains("active")&&(j.classList.remove("active"),e.data&&e.data[B]&&S.push(e.data[B]))}),S.length&&t("update:checked",S),document.removeEventListener("mousemove",w),document.removeEventListener("mouseup",$)};document.addEventListener("mousemove",w),document.addEventListener("mouseup",$)}}}}),mt=(e,t)=>{const c=e.__vccOpts||e;for(const[r,a]of t)c[r]=a;return c};function ut(e,t,c,r,a,f){const v=ne("FileGrid"),_=ne("FileTable");return b(),O("div",{class:"ele-file-list-group",onMousedown:t[0]||(t[0]=(...d)=>e.onMousedown&&e.onMousedown(...d))},[e.grid?(b(),D(v,{key:0,data:e.data,icons:e.icons,selection:e.checked,checkbox:e.checkbox,checked:e.allChecked,indeterminate:e.indeterminate,total:e.checked?e.checked.length:0,"total-text":e.locale.selectTips,"check-all-text":e.locale.selectAll,onCheckAllChange:e.checkAllChange,onItemClick:e.onItemClick,onItemCheckChange:e.itemCheckChange},le({_:2},[G(Object.keys(e.$slots),d=>({name:d,fn:k(i=>[ce(e.$slots,d,ie(se(i||{})))])}))]),1032,["data","icons","selection","checkbox","checked","indeterminate","total","total-text","check-all-text","onCheckAllChange","onItemClick","onItemCheckChange"])):(b(),D(_,{key:1,data:e.data,icons:e.icons,selection:e.checked,checkbox:e.checkbox,checked:e.allChecked,indeterminate:e.indeterminate,total:e.checked?e.checked.length:0,"total-text":e.locale.selectTips,"check-all-text":e.locale.selectAll,"name-text":e.locale.fileName,"size-text":e.locale.fileSize,"time-text":e.locale.fileTimestamp,sort:e.sort,order:e.order,columns:e.columns,onCheckAllChange:e.checkAllChange,onItemClick:e.onItemClick,onItemCheckChange:e.itemCheckChange,onSortChange:e.onSortChange},le({_:2},[G(Object.keys(e.$slots),d=>({name:d,fn:k(i=>[ce(e.$slots,d,ie(se(i||{})))])}))]),1032,["data","icons","selection","checkbox","checked","indeterminate","total","total-text","check-all-text","name-text","size-text","time-text","sort","order","columns","onCheckAllChange","onItemClick","onItemCheckChange","onSortChange"])),x("div",{class:"ele-file-list-selector",style:pe(e.selectorStyle)},null,4)],32)}const ht=mt(dt,[["render",ut]]);var ft={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M484 443.1V528h-84.5c-4.1 0-7.5 3.1-7.5 7v42c0 3.8 3.4 7 7.5 7H484v84.9c0 3.9 3.2 7.1 7 7.1h42c3.9 0 7-3.2 7-7.1V584h84.5c4.1 0 7.5-3.2 7.5-7v-42c0-3.9-3.4-7-7.5-7H540v-84.9c0-3.9-3.1-7.1-7-7.1h-42c-3.8 0-7 3.2-7 7.1zm396-144.7H521L403.7 186.2a8.15 8.15 0 00-5.5-2.2H144c-17.7 0-32 14.3-32 32v592c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V330.4c0-17.7-14.3-32-32-32zM840 768H184V256h188.5l119.6 114.4H840V768z"}}]},name:"folder-add",theme:"outlined"};const pt=ft;function he(e){for(var t=1;t<arguments.length;t++){var c=arguments[t]!=null?Object(arguments[t]):{},r=Object.keys(c);typeof Object.getOwnPropertySymbols=="function"&&(r=r.concat(Object.getOwnPropertySymbols(c).filter(function(a){return Object.getOwnPropertyDescriptor(c,a).enumerable}))),r.forEach(function(a){_t(e,a,c[a])})}return e}function _t(e,t,c){return t in e?Object.defineProperty(e,t,{value:c,enumerable:!0,configurable:!0,writable:!0}):e[t]=c,e}var K=function(t,c){var r=he({},t,c.attrs);return h(De,he({},r,{icon:pt}),null)};K.displayName="FolderAddOutlined";K.inheritAttrs=!1;const gt=K;async function vt(e){const t=await V.get("/system/user-file",{params:e});return t.data.code===0&&t.data.data?t.data.data:Promise.reject(new Error(t.data.message))}async function we(e){const t=await V.post("/system/user-file",e);return t.data.code===0?t.data.message:Promise.reject(new Error(t.data.message))}async function yt(e){const t=await V.put("/system/user-file",e);return t.data.code===0?t.data.message:Promise.reject(new Error(t.data.message))}async function kt(e){const t=await V.delete("/system/user-file/"+e);return t.data.code===0?t.data.message:Promise.reject(new Error(t.data.message))}async function bt(e){const t=await V.delete("/system/user-file/batch",{data:e});return t.data.code===0?t.data.message:Promise.reject(new Error(t.data.message))}const xt={__name:"folder-add",props:{visible:Boolean,parentId:Number},emits:["done","update:visible"],setup(e,{emit:t}){const c=e,r=I(null),a=I(!1),{form:f,resetFields:v}=_e({name:""}),_=q({name:[{required:!0,message:"请输入文件夹名称",type:"string",trigger:"blur"}]}),d=()=>{r.value&&r.value.validate().then(()=>{a.value=!0,we({...f,parentId:c.parentId,isDirectory:1}).then(o=>{a.value=!1,A.success(o),i(!1),t("done")}).catch(o=>{a.value=!1,A.error(o.message)})}).catch(()=>{})},i=o=>{t("update:visible",o)};return ge(()=>c.visible,o=>{var m;o||(v(),(m=r.value)==null||m.clearValidate())}),(o,m)=>{const y=ve,n=ye,p=ke,s=be;return b(),D(s,{width:460,visible:e.visible,"confirm-loading":a.value,title:"新建文件夹","body-style":{paddingBottom:"8px"},"onUpdate:visible":i,onOk:d},{default:k(()=>[h(p,{ref_key:"formRef",ref:r,model:C(f),rules:_,"label-col":{md:6,sm:6,xs:24},"wrapper-col":{md:18,sm:18,xs:24}},{default:k(()=>[h(n,{label:"文件夹名称",name:"name"},{default:k(()=>[h(y,{"allow-clear":"",maxlength:20,placeholder:"请输入文件夹名称",value:C(f).name,"onUpdate:value":m[0]||(m[0]=l=>C(f).name=l)},null,8,["value"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["visible","confirm-loading"])}}};const ee=e=>(J("data-v-fa6139a5"),e=e(),Q(),e),Ct=ee(()=>x("span",null,"上传",-1)),It=ee(()=>x("span",null,"新建文件夹",-1)),wt=ee(()=>x("span",null,"删除",-1)),St={__name:"file-toolbar",props:{grid:Boolean,checked:Array,parentId:Number},emits:["update:grid","done"],setup(e,{emit:t}){const c=e,r=Ee(),{styleResponsive:a}=Be(r),f=I(""),v=I(!1),_=({file:y})=>{if(y.size/1024/1024>100)return A.error("大小不能超过 100MB"),!1;const n=X("上传中..",0);return Xe(y).then(p=>{we({name:p.name,isDirectory:0,parentId:c.parentId,path:p.path,length:p.length,contentType:p.contentType}).then(()=>{n(),A.success("上传成功"),o()}).catch(s=>{n(),A.error(s.message)})}).catch(p=>{n(),A.error(p.message)}),!1},d=()=>{v.value=!0},i=()=>{xe.confirm({title:"提示",content:"确定要删除选中的文件吗?",icon:h(Ce),maskClosable:!0,onOk:()=>{const y=X("请求中..",0);bt(c.checked.map(n=>n.id)).then(n=>{y(),A.success(n),o()}).catch(n=>{y(),A.error(n.message)})}})},o=()=>{t("done")},m=()=>{t("update:grid",!c.grid)};return(y,n)=>{const p=Me,s=Ye,l=Le,g=Ue,w=We;return b(),O(R,null,[h(w,null,{action:k(()=>[x("div",{style:{"max-width":"240px"},class:P({"hidden-sm-and-down":C(a)})},[h(g,{value:f.value,"onUpdate:value":n[0]||(n[0]=$=>f.value=$),placeholder:"搜索您的文件"},null,8,["value"])],2),e.grid?(b(),D(C(Je),{key:0,class:"ele-file-tool-btn",onClick:m})):(b(),D(C(je),{key:1,class:"ele-file-tool-btn",onClick:m}))]),default:k(()=>[h(l,null,{default:k(()=>[h(s,{"show-upload-list":!1,customRequest:_},{default:k(()=>[h(p,{type:"primary",class:"ele-btn-icon"},{icon:k(()=>[h(C(Ze))]),default:k(()=>[Ct]),_:1})]),_:1}),h(p,{type:"dashed",class:"ele-btn-icon",onClick:d},{icon:k(()=>[h(C(gt))]),default:k(()=>[It]),_:1}),h(p,{danger:"",type:"dashed",disabled:!e.checked.length,class:P(["ele-btn-icon",{"hidden-xs-only":C(a)}]),onClick:i},{icon:k(()=>[h(C(Ie))]),default:k(()=>[wt]),_:1},8,["disabled","class"])]),_:1})]),_:1}),h(xt,{visible:v.value,"onUpdate:visible":n[1]||(n[1]=$=>v.value=$),"parent-id":e.parentId,onDone:o},null,8,["visible","parent-id"])],64)}}},At=Z(St,[["__scopeId","data-v-fa6139a5"]]);const $t=e=>(J("data-v-fa5a0e6e"),e=e(),Q(),e),Ft={class:"ele-file-breadcrumb-group ele-cell"},Ot={class:"ele-cell-content ele-cell"},Tt={class:"ele-file-breadcrumb-list ele-cell-content ele-cell"},Dt=$t(()=>x("div",{class:"ele-file-breadcrumb-item-title"},"全部文件",-1)),Et=["onClick"],Bt={class:"ele-file-breadcrumb-item-title"},jt={class:"hidden-xs-only"},Mt={__name:"file-header",props:{directorys:Array,total:Number},emits:["update:directorys"],setup(e,{emit:t}){const c=e,r=()=>{t("update:directorys",c.directorys.slice(0,c.directorys.length-1))},a=()=>{c.directorys.length&&t("update:directorys",[])},f=v=>{v!==c.directorys.length-1&&t("update:directorys",c.directorys.slice(0,v+1))};return(v,_)=>(b(),O("div",Ft,[x("div",Ot,[e.directorys.length?(b(),O("div",{key:0,class:"ele-file-breadcrumb-back ele-text-primary",onClick:r}," 返回上一级 ")):L("",!0),x("div",Tt,[x("div",{class:P(["ele-file-breadcrumb-item ele-cell",{"ele-text-primary":!!e.directorys.length}]),onClick:a},[Dt,e.directorys.length?(b(),D(C(oe),{key:0,class:"ele-text-secondary"})):L("",!0)],2),(b(!0),O(R,null,G(e.directorys,(d,i)=>(b(),O("div",{key:d.id,class:P(["ele-file-breadcrumb-item ele-cell",{"ele-text-primary":i!==e.directorys.length-1}]),onClick:o=>f(i)},[x("div",Bt,ae(d.name),1),i!==e.directorys.length-1?(b(),D(C(oe),{key:0,class:"ele-text-secondary"})):L("",!0)],10,Et))),128))])]),x("div",jt,"已全部加载，共 "+ae(e.total)+" 个",1)]))}},Lt=Z(Mt,[["__scopeId","data-v-fa5a0e6e"]]);const Ut={__name:"name-edit",props:{visible:Boolean,data:Object},emits:["done","update:visible"],setup(e,{emit:t}){const c=e,r=I(null),a=I(!1),{form:f,resetFields:v}=_e({name:""}),_=q({name:[{required:!0,message:"请输入文件/夹名称",type:"string",trigger:"blur"}]}),d=()=>{r.value&&r.value.validate().then(()=>{var o;a.value=!0,yt({...f,id:(o=c.data)==null?void 0:o.id}).then(m=>{a.value=!1,A.success(m),i(!1),t("done")}).catch(m=>{a.value=!1,A.error(m.message)})}).catch(()=>{})},i=o=>{t("update:visible",o)};return ge(()=>c.visible,o=>{var m;o?c.data&&(f.name=c.data.name):(v(),(m=r.value)==null||m.clearValidate())}),(o,m)=>{const y=ve,n=ye,p=ke,s=be;return b(),D(s,{width:460,visible:e.visible,"confirm-loading":a.value,title:"重命名","body-style":{paddingBottom:"8px"},"onUpdate:visible":i,onOk:d},{default:k(()=>[h(p,{ref_key:"formRef",ref:r,model:C(f),rules:_,"label-col":{md:6,sm:6,xs:24},"wrapper-col":{md:18,sm:18,xs:24}},{default:k(()=>[h(n,{label:"文件/夹名称",name:"name"},{default:k(()=>[h(y,{"allow-clear":"",maxlength:20,placeholder:"请输入文件/夹名称",value:C(f).name,"onUpdate:value":m[0]||(m[0]=l=>C(f).name=l)},null,8,["value"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["visible","confirm-loading"])}}};const H=e=>(J("data-v-b11dd386"),e=e(),Q(),e),Nt={class:"demo-file-list-group"},zt={class:"ele-cell"},Pt=H(()=>x("div",{class:"ele-cell-content"},"下载",-1)),Vt={class:"ele-cell"},Gt=H(()=>x("div",{class:"ele-cell-content"},"重命名",-1)),Rt={class:"ele-cell"},qt=H(()=>x("div",{class:"ele-cell-content"},"移动到",-1)),Ht={class:"ele-cell ele-text-danger"},Wt=H(()=>x("div",{class:"ele-cell-content"},"删除",-1)),Yt={key:0,class:"demo-file-list-empty"},Xt={style:{display:"none"}},Zt={__name:"file-list",props:{parentId:Number,data:Array,sort:String,order:String,checked:Array,grid:Boolean},emits:["sort-change","update:checked","go-directory","done"],setup(e,{emit:t}){const c=e,r=q({current:0,visible:!1,onVisibleChange:s=>{r.visible=s}}),a=I([]),f=I(!1),v=I(),_=s=>{t("sort-change",s)},d=s=>{t("update:checked",s)},i=s=>{s.isDirectory?t("go-directory",s):n(s)?p(s):d(c.checked.includes(s)?c.checked.filter(l=>l!==s):[...c.checked,s])},o=(s,l)=>{s==="open"?l.isDirectory||n(l)?i(l):window.open(l.url):s==="download"?typeof l.downloadUrl=="string"&&window.open(l.downloadUrl):s==="edit"?(v.value=l,f.value=!0):s==="remove"&&m(l)},m=s=>{xe.confirm({title:"提示",content:"确定要删除此文件吗?",icon:h(Ce),maskClosable:!0,onOk:()=>{const l=X("请求中..",0);kt(s.id).then(g=>{l(),A.success(g),y()}).catch(g=>{l(),A.error(g.message)})}})},y=()=>{t("done")},n=s=>typeof s.contentType=="string"&&s.contentType.startsWith("image/")&&s.url,p=s=>{a.value=c.data.filter(g=>n(g));const l=a.value.indexOf(s);l!==-1&&(r.current=l,r.visible=!0)};return(s,l)=>{const g=Pe,w=Ve,$=Ge,S=ht,M=Re,j=Qe,B=Ke;return b(),O(R,null,[x("div",Nt,[h(S,{data:e.data,grid:e.grid,sort:e.sort,order:e.order,checked:e.checked,style:pe({minHeight:"400px",minWidth:e.grid?"auto":"456px"}),onItemClick:i,onSortChange:_,"onUpdate:checked":d},{"context-menu":k(({item:F})=>[h($,{selectable:!1,onClick:({key:N})=>o(N,F)},{default:k(()=>[h(g,{key:"open"},{default:k(()=>[Ne("打开")]),_:1}),h(w),F.isDirectory?L("",!0):(b(),D(g,{key:"download"},{default:k(()=>[x("div",zt,[h(C(et)),Pt])]),_:1})),h(g,{key:"edit"},{default:k(()=>[x("div",Vt,[h(C(tt)),Gt])]),_:1}),h(g,{key:"move"},{default:k(()=>[x("div",Rt,[h(C(ze)),qt])]),_:1}),h(w),h(g,{key:"remove"},{default:k(()=>[x("div",Ht,[h(C(Ie)),Wt])]),_:1})]),_:2},1032,["onClick"])]),_:1},8,["data","grid","sort","order","checked","style"]),e.data.length?L("",!0):(b(),O("div",Yt,[h(M)]))]),x("div",Xt,[r.visible?(b(),D(B,{key:0,preview:r},{default:k(()=>[(b(!0),O(R,null,G(a.value,F=>(b(),D(j,{key:String(F.id),src:F.url},null,8,["src"]))),128))]),_:1},8,["preview"])):L("",!0)]),h(Ut,{visible:f.value,"onUpdate:visible":l[0]||(l[0]=F=>f.value=F),data:v.value,onDone:y},null,8,["visible","data"])],64)}}},Jt=Z(Zt,[["__scopeId","data-v-b11dd386"]]),Qt={class:"ele-body"},Kt={style:{padding:"16px 16px 12px 16px"}},en={name:"ExtensionFile"},_n=Object.assign(en,{setup(e){const t=I(!0),c=I([]),r=I(""),a=I(""),f=I([]),v=I([]),_=I(0),d=I(!0),i=I(0),o=()=>{c.value=[],f.value=[],t.value=!0,vt({sort:a.value?r.value:"",order:a.value,parentId:i.value}).then(l=>{t.value=!1,c.value=l.map(g=>Object.assign({name:g.name},g,{isDirectory:g.isDirectory===1,length:s(g.length)})),_.value=l.length}).catch(l=>{t.value=!1,A.error(l.message)})},m=()=>{o()},y=l=>{a.value=l.order,r.value=l.sort,o()},n=l=>{p([...v.value,l])},p=l=>{var g,w;v.value=l,i.value=(w=(g=v.value[v.value.length-1])==null?void 0:g.id)!=null?w:0,o()},s=l=>l==null?"-":l<1024?l+"B":l<1024*1024?(l/1024).toFixed(1)+"KB":l<1024*1024*1024?(l/1024/1024).toFixed(1)+"M":(l/1024/1024/1024).toFixed(1)+"G";return o(),(l,g)=>{const w=qe,$=He;return b(),O("div",Qt,[h($,{bordered:!1,"body-style":{padding:0}},{default:k(()=>[x("div",Kt,[h(At,{grid:d.value,"onUpdate:grid":g[0]||(g[0]=S=>d.value=S),checked:f.value,parentId:i.value,onDone:m},null,8,["grid","checked","parentId"]),h(Lt,{total:_.value,directorys:v.value,"onUpdate:directorys":p},null,8,["total","directorys"])]),h(w,{spinning:t.value},{default:k(()=>[h(Jt,{grid:d.value,data:c.value,sort:r.value,order:a.value,parentId:i.value,checked:f.value,"onUpdate:checked":g[1]||(g[1]=S=>f.value=S),onSortChange:y,onGoDirectory:n,onDone:m},null,8,["grid","data","sort","order","parentId","checked"])]),_:1},8,["spinning"])]),_:1})])}}});export{_n as default};
